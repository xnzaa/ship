<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0052)http://blog.csdn.net/wuyazhe/article/details/5606276 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/nick"></script>
<title>C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET</title>

<meta name="description" content="     第一篇文章我相信很多人不看都能做的出来，但是，用过微软SerialPort类的人，都遇到过这个尴尬，关闭串口的时候会让软件死锁。天哪，我可不是武断，算了。不要太绝对了。99.9%的人吧，都遇到过这个问题。我想只有一半的人真的解决了。另外一半的人就睁只眼闭只眼阿弥佗佛希望不要在客户那里出现这问题了。     你看到我的文章，就放心吧，这问题有救了。我们先回顾一下上一篇中的代码 ">
<script type="text/javascript" async="" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ga.js"></script><script src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/jquery.js" type="text/javascript"></script>
<script src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/plugins.js" type="text/javascript"></script>
<script src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/common.js" type="text/javascript"></script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ad.js"></script>
<link rel="Stylesheet" type="text/css" href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/style.css">
<link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://blog.csdn.net/wuyazhe/rss/list">
<link rel="shortcut icon" href="http://blog.csdn.net/favicon.ico">
<link type="text/css" rel="stylesheet" href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/default.css">
<style type="text/css" id="LB_ADBLOCK_0">.ad_960,.banner_top2,.banner_top3,[src*="&sourcesuninfo=ad-"],.adarea,.adarea_top,#lovexin1,#lovexin2,.m_ad,#topBanner,.ad1,.ad2,.ad3,.ad4,.ad5,.ad6,.ad7,.ad8,.ad9,.adSpace,.ad_240_h,.side-Rad,.ol_ad_xiala,iframe[src^="http://a.cntv.cn"],[id^="youku_ad_"],#bd1,#bd2,#bd3,.h8r.font0,.topbod>.topbodr,.topbodr>table[width="670"][height="70"],.widget_ad_slot_wrapper,.gg01,.gg02,.gg03,.gg04,.gg05,.gg06,.gg07,.gg08,.gg09,#_SNYU_Ad_Wrap,[id^="snyu_slot_"],.random-box>.random-banner,.gonglue_rightad,iframe[src^="http://www.37cs.com/html/click/"],#AdZoneRa,#AdZoneRb,#AdZoneRc,#AdZoneRd,#AdZoneRe,#AdZoneRf,#AdZoneRg,div[id="adAreaBbox"],.absolute.a_cover,#QQCOM_Width3,#auto_gen_6,.l_qq_com,#cj_ad,[href^="http://c.l.qq.com/adsclick?oid="],.right_ad_lefttext,.right_ad_righttext,.AdTop-Article-QQ,.business-Article-QQ,.qiye-Article-QQ,.AdBox-Article-QQ,td[width="960"][height="90"][align="center"],.adclass,.ad1,[id^="tonglan_"],.ads5,.adv,.ads220_60,.ad-h60,.ad-h65,.ggs,[class^="ads360"],.news_ad_box,#XianAd,.Ad3Top-Article-QQ,.AdTop2-Article-QQ,.adbutton-Aritcle-QQ,#AdRight-Article-QQ,[id^=ad-block],.sidBoxNoborder.mar-b8,#ent_ad,[class="ad"][id="ad_bottom"],[class="ad"][id="ad_top"],.plrad,.ad300,#top_ad1,#top_ad2,#top_ad3,#top_ad4,#top_ad5,#top_ad6,#top_ad7,#top_ad8,#top_ad9,#mid_ad1,#mid_ad2,#mid_ad3,#mid_ad4,#mid_ad5,#mid_ad6,#mid_ad7,#mid_ad8,#mid_ad9,#ads1,#ads2,#ads3,#ads4,#ads5,#ads6,#ads7,#ads8,#ads9,.dlAd,.changeAd,.unionCpv,#Advertisement,iframe[src*="/advertisement."],img[src*="/advertisement."],.ad_headerbanner,#ad_headerbanner,div[class^=ad_textlink],iframe[src*="guanggao"],img[src*="guanggao"],#ads-top,#ads-bot,.adBanner,#topAd,.top_ad,.topAds,.topAd,.ad_column,#ad1,#ad2,#ad3,#ad4,#ad5,#ad6,#ad7,#ad8,#ad9,.ad_footerbanner,#adleft,#adright,.advleft,.advright,.ad980X60,.banner-ad,.top-ad,#adright,#AdLayer1,#AdLayer2,#AdLayer3,div[href*="click.mediav.com"],div[class=top_ad],div[class^="headads"],div[class="ads"],.txtad,.guanggao,#guanggao,.adclass,div[id*="AdsLayer"],.ad950,.guangg,.header-ads-top,#adleft,#adright,#ad_show,.ad_pic,#fullScreenAd,div[class^="adbox"],#topADImg,div[class^="ad_box"],div[id^="adbox"],div[class^="ads_"],div[alt*="￥ﾹ﾿￥ﾑﾊ￤ﾽﾍ"],div[id^="ads_"],div[src*="/adfile/"],.delayadv,#vplayad,.jadv,div[src*="/ads/"],div[src*="/advpic/"],div[id*="_adbox"],div[id*="-adbox"],div[class^="showad"],div[id^="adshow"],#bottomads,.ad_column,div[id^="_AdSame"],iframe[src^="http://drmcmm.baidu.com"],div[src^="http://drmcmm.baidu.com"],frame[src^="http://drmcmm.baidu.com"],div[href^="http://www.baidu.com/cpro.php?"],iframe[href^="http://www.baidu.com/cpro.php?"],div[src^="http://cpro.baidu.com"],div[src^="http://eiv.baidu.com"],div[href^="http://www.baidu.com/baidu.php?url="],div[href^="http://www.baidu.com/adrc.php?url="],.ad_text,div[href^="http://click.cm.sandai.net"],div.adA.area,div[src*=".qq937.com"],iframe[src*=".qq937.com"],div[src*=".88210212.com"],iframe[src*=".88210212.com"],.adBox,.adRight,.adLeft,.banner-ads,.right_ad,.left_ad,.content_ad,.post-top-gg,div[class*="_ad_slot"],.col_ad,.block_ad,div[class^="adList"],.adBlue,.mar_ad,div[id^="ArpAdPro"],.adItem,.ggarea,.adiframe,iframe[src*="/adiframe/"],#bottom_ad,.bottom_ad,.crumb_ad,.topadna,.topadbod,div[src*="qq494.cn"],iframe[src*="qq494.cn"],.topadbod,embed[src*="gamefiles.qq937.com"],embed[src*="17kuxun.com"],.crazy_ad_layer,#crazy_ad_layer,.bannerad,iframe[src*="/ads/"],img[src*="/ads/"],embed[src*="/ads/"],#crazy_ad_float,.crazy_ad_float,.main_ad,.topads,div[class^="txtadsblk"],.head-ad,div[src*="/728x90."],img[src*="/728x90."],embed[src*="/728x90."],iframe[src*="/gg/"],img[src*="/gg/"],iframe[src^="http://www.460.com.cn"],#bg_ad,.ad_pic,iframe[src*="gg.yxdown.com"],.ad_top,#baiduSpFrame,.flashad,#flashad,#ShowAD,[onclick^="ad_clicked"],[class^="ad_video_"],#ad_240,.wp.a_f,.a_mu,#hd_ad,#top_ads,#header_ad,#adbanner,#adbanner_1,#Left_bottomAd,#Right_bottomAd,#ad_alimama,#vipTip,.ad_pip,#show-gg,.ad-box,.advbox,.widget-ads.banner,.a760x100,.a200x375,.a760x100,.a200x100,.ad_left,.ad_right{display:none !important;}</style></head>
<body>
<script src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/pub_topnav_2011.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/navtop_2012.css">
<div class="nav_top_2011">
<p><span style="color:red;">您还未登录！</span>|<a href="https://passport.csdn.net/account/login" target="_top">登录</a>|<a href="https://passport.csdn.net/account/register" target="_top">注册</a>|<a href="https://passport.csdn.net/help/faq" target="_blank">帮助</a></p><ul>
<li><a href="http://www.csdn.net/" target="_blank">首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">业界</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">研发</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li class="more"><h2 id="topnav_btnmore" onclick="showNavMore(this)"><a href="javascript:void(0);">更多</a></h2>
<div id="topnav_hidlist">
<iframe name="nav_frm" src="about:blank" width="92" height="178" scrolling="no" frameborder="no"></iframe>
</div>
</li>
</ul>
</div>


<div id="container">
<div id="header">
    <div class="header">
        <div id="blog_title">
            <h1><a href="http://blog.csdn.net/wuyazhe">不要抱怨，要不断的追求，上帝才会给你。</a></h1>
            <h2></h2>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg"></div>
    <div class="navigator">
        <ul>
            <li id="btnContents"><a href="http://blog.csdn.net/wuyazhe?viewmode=contents"><span><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ico_list.gif">目录视图</span></a></li>
            <li id="btnView"><a href="http://blog.csdn.net/wuyazhe?viewmode=list"><span><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ico_summary.gif">摘要视图</span></a></li>
            <li id="btnRss"><a href="http://blog.csdn.net/wuyazhe/rss/list"><span><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ico_rss.gif">订阅</span></a></li>
</ul>
    </div>
</div>
<script type="text/javascript">
    var username = "wuyazhe";
    var blog_address = "http://blog.csdn.net/wuyazhe";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";
</script>
        
<div id="body">
<div id="main">
<div class="main">
<div class="notice"> 

<a href="http://blog.csdn.net/blogdevteam/article/details/8472541" target="_blank">
<font color="blue">
2013年1月当选微软MVP名单揭晓！   </font></a>



&nbsp;&nbsp;

<a href="http://blog.csdn.net/blogdevteam/article/details/8534797" target="_blank"><font color="red">智能开发框架 JEECG 作者张代浩专访</font></a>


<br>





<a href="http://vote.blog.csdn.net/details/blogstar" target="_blank">
<font color="red">2012CSDN博客之星火热出炉！ </font></a>


&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/csdnstudent/article/details/8077932" target="_blank">
<font color="red">2013年全国百所高校巡讲讲师招募  </font></a>


</div><div id="article_details" class="details">
    <div class="article_title">
    <span class="ico ico_type_Original"></span>
    <h3>
        <span class="link_title"><a href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET.htm">
        C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？
        </a></span>
    </h3>
</div>

        
    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="http://blog.csdn.net/wuyazhe/article/category/695097">通讯类库设计</a> 
        </span>
    <span class="link_postdate">2010-05-19 08:43</span>
    <span class="link_view" title="阅读次数">26328人阅读</span>
    <span class="link_comments" title="评论次数"><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#comments">评论</a>(163)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle(&#39;C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？&#39;,&#39;5606276&#39;);return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" onclick="javascript:report(5606276,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href="http://blog.csdn.net/tag/details.html?tag=c%23" target="_blank">c#</a><a href="http://blog.csdn.net/tag/details.html?tag=object" target="_blank">object</a><a href="http://blog.csdn.net/tag/details.html?tag=ui" target="_blank">ui</a><a href="http://blog.csdn.net/tag/details.html?tag=byte" target="_blank">byte</a><a href="http://blog.csdn.net/tag/details.html?tag=%e9%80%9a%e8%ae%af" target="_blank">通讯</a><a href="http://blog.csdn.net/tag/details.html?tag=.net" target="_blank">.net</a></div>


    
<div id="article_content" class="article_content">
<p>&nbsp;&nbsp;&nbsp;&nbsp; 第一篇文章我相信很多人不看都能做的出来，但是，用过微软SerialPort类的人，都遇到过这个尴尬，关闭串口的时候会让软件死锁。天哪，我可不是武断，算了。不要太绝对了。99.9%的人吧，都遇到过这个问题。我想只有一半的人真的解决了。另外一半的人就睁只眼闭只眼阿弥佗佛希望不要在客户那里出现这问题了。</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 你看到我的文章，就放心吧，这问题有救了。我们先回顾一下上一篇中的代码</p>
<p>&nbsp;&nbsp;&nbsp; <div class="dp-highlighter bg_c-sharp"><div class="bar"><div class="tools"><b>[c-sharp]</b> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="ViewSource" title="view plain" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="CopyToClipboard" title="copy" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="PrintSource" title="print" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="About" title="?" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a><div style="position: absolute; left: 585px; top: 642px; width: 18px; height: 18px; z-index: 99; "><embed id="ZeroClipboardMovie_1" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=18&amp;height=18" wmode="transparent"></div></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="keyword">void</span><span>&nbsp;comm_DataReceived(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;SerialDataReceivedEventArgs&nbsp;e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class=""><span>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//先记录下来，避免某种原因，人为的原因，操作几次之间时间长，缓存不一致</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;n&nbsp;=&nbsp;comm.BytesToRead;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//声明一个临时数组存储当前来的串口数据</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[n];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//增加接收计数</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;received_count&nbsp;+=&nbsp;n;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//读取缓冲数据&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;comm.Read(buf,&nbsp;0,&nbsp;n);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//清除字符串构造器的内容</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;builder.Clear();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//因为要访问ui资源，所以需要使用invoke方式同步ui。&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.Invoke((EventHandler)(</span><span class="keyword">delegate</span><span>{...界面更新，略}));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;buttonOpenClose_Click(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class=""><span>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//根据当前串口对象，来判断操作&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(comm.IsOpen)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//打开时点击，则关闭串口&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Close();<span class="comment">//这里就是可能导致软件死掉的地方</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{...}&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><textarea cols="85" rows="26" name="code" class="c-sharp" style="display: none; ">void comm_DataReceived(object sender, SerialDataReceivedEventArgs e)   
{   
    //先记录下来，避免某种原因，人为的原因，操作几次之间时间长，缓存不一致
    int n = comm.BytesToRead;
    //声明一个临时数组存储当前来的串口数据
    byte[] buf = new byte[n];   
    //增加接收计数
    received_count += n; 
    //读取缓冲数据  
    comm.Read(buf, 0, n);   
    //清除字符串构造器的内容
    builder.Clear();   
    //因为要访问ui资源，所以需要使用invoke方式同步ui。   
    this.Invoke((EventHandler)(delegate{...界面更新，略}));   
}   
  
private void buttonOpenClose_Click(object sender, EventArgs e)   
{   
    //根据当前串口对象，来判断操作   
    if (comm.IsOpen)   
    {   
        //打开时点击，则关闭串口   
        comm.Close();//这里就是可能导致软件死掉的地方
    }   
    else  
    {...}  
}</textarea> </p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 为什么会死锁呢，并发冲突。</p>
<p>&nbsp;&nbsp;&nbsp; 我们要了解一下SerialPort的实现和串口通讯机制，在你打开串口的时候，SerialPort会创建一个监听线程ListenThread，在这个线程中，等待注册的串口中断，当收到中断后，会调用DataReceived事件。调用完成后，继续进入循环等待，直到串口被关闭退出线程。</p>
<p>&nbsp;&nbsp;&nbsp; 我们的UI主线程如何做的呢，首先创建一个窗体，然后执行了Application.Run(窗体实例)。是这样把，这里的Application.Run就是创建了一个消息循环，循环的处理相关的消息。</p>
<p>&nbsp;&nbsp;&nbsp; 这里我们就有了2个线程，UI主线程、串口监听线程。那么你在DataReceived处理数据的时候，就需要线程同步，避免并发冲突，什么是并发冲突？并发冲突就是2个或多个并行(至少看上去像)的线程运行的时候，多个线程共同的操作某一线程的资源，在时序上同时或没有按我们的预计顺序操作，这样就可能导致数据混乱无序或是彼此等待完成死锁软件。</p>
<p>&nbsp;&nbsp;&nbsp; 而串口程序大多是后者。为什么呢，看看我们的例子中DataReceived做了什么？首先读取数据，然后就是调用this.Invoke方法更新UI了。这里Invoke的时候，监听线程将等待UI线程的标志，等到后，开始操作UI的资源，当操作完成之前，监听线程也就停在DataReceived方法的调用这里，如果这个时候。并发了关闭串口的操作会如何呢？SerialPort的Close方法，会首先尝试等待和监听线程一样的一个互斥体、临界区、或是事件（不确定.net用的哪种）。那这个同步对象什么时候释放呢？每次循环结束就释放，哦。循环为什么不结束呢？因为这一次的循环操作执行到DataReceived之后，执行了Invoke去更新界面了，那Invoke怎么又没有执行完成呢？看上去很简单的几行代码。虽然我没仔细研读过.net的Invoke原理，但我猜测是通过消息的方式来同步的，这也是为什么这么多的类，只有控件（窗体也是控件的一种，.net在概念上，颠覆了微软自己的概念，传统的win32编程，是说所有的控件都是个window，只是父窗体不同，表现形式不同，但都是基于系统消息队列的，.net出于更高的抽象，正好反过来了。呵呵）才有Invoke方法了。(委托自己的Invoke和这个不同)</p>
<p>&nbsp;&nbsp;&nbsp; 我猜测控件/窗体的Invoke是SendMessage方式实现的，那么发送消息后就会等待消息循环来处理消息了。如果你直接去关闭串口了。你点击按钮本身也会被转换成消息WM_CLICK，消息循环在处理按钮的WM_CLICK时候，调用你按钮的OnClick方法，进而触发调用你的ButtonClose_Click事件，这都是同步调用的，你的主线程，处理消息的过程，停在了这个Click事件，而你的Click事件又去调用了SerialPort的Close方法，Close方法又因为和串口监听线程的同步信号量关联在一起需要等待一次的while结束，而这个while循环中调用了DataReceived方法，这个方法中调用了Invoke，也就是发送了消息到消息队列等待结果，但消息循环正在处理你的关闭按钮事件等待退出。</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 实在太复杂了，这个情况下，你想要真的关闭串口成功，就需要while中的DataReceived方法调用结束释放同步信号，就需要执行完Invoke，就需要执行消息循环，幸运的是，我们真的有办法执行消息循环来打破僵局。Application.DoEvents()。还好，不幸中的万幸。可是问题又来了，你能让Invoke结束，但你无法确定是否在你调用消息循环后，你的某一时刻不会再次并发，可能由于单cpu的串行操作模拟并行中，又把时间片先分给了优先级高的串口监听线程呢？是有可能的。所以，我们就需要一点方法来避免再次invoke窗体。优化后不会司机的例子如下，我们修改DataReceived方法，关闭方法，并定义2个标记Listening和Closing。</p>
<p>&nbsp;</p>
<p><div class="dp-highlighter bg_c-sharp"><div class="bar"><div class="tools"><b>[c-sharp]</b> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="ViewSource" title="view plain" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="CopyToClipboard" title="copy" onclick="dp.sh.Toolbar.Command(&#39;CopyToClipboard&#39;,this);return false;">copy</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="PrintSource" title="print" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="About" title="?" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a><div style="position: absolute; left: 585px; top: 2259px; width: 18px; height: 18px; z-index: 99; "><embed id="ZeroClipboardMovie_2" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="18" height="18" name="ZeroClipboardMovie_2" align="middle" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=18&amp;height=18" wmode="transparent"></div></div></div><ol start="1" class="dp-c"><li class="alt"><span><span class="keyword">using</span><span>&nbsp;System;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">using</span><span>&nbsp;System.Collections.Generic;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">using</span><span>&nbsp;System.ComponentModel;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">using</span><span>&nbsp;System.Data;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">using</span><span>&nbsp;System.Drawing;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">using</span><span>&nbsp;System.Linq;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">using</span><span>&nbsp;System.Text;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">using</span><span>&nbsp;System.Windows.Forms;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">using</span><span>&nbsp;System.IO.Ports;&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">using</span><span>&nbsp;System.Text.RegularExpressions;&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">namespace</span><span>&nbsp;SerialportSample&nbsp;&nbsp;</span></span></li><li class=""><span>{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;partial&nbsp;</span><span class="keyword">class</span><span>&nbsp;SerialportSampleForm&nbsp;:&nbsp;Form&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;SerialPort&nbsp;comm&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;SerialPort();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;StringBuilder();</span><span class="comment">//避免在事件处理方法中反复的创建，定义到外面。</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;received_count&nbsp;=&nbsp;0;</span><span class="comment">//接收计数</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;send_count&nbsp;=&nbsp;0;</span><span class="comment">//发送计数</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">bool</span><span>&nbsp;Listening&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span><span class="comment">//是否没有执行完invoke相关操作</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">bool</span><span>&nbsp;Closing&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span><span class="comment">//是否正在关闭串口，执行Application.DoEvents，并阻止再次invoke</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;SerialportSampleForm()&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//窗体初始化</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;Form1_Load(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//初始化下拉串口名称列表框</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span><span>[]&nbsp;ports&nbsp;=&nbsp;SerialPort.GetPortNames();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array.Sort(ports);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comboPortName.Items.AddRange(ports);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comboPortName.SelectedIndex&nbsp;=&nbsp;comboPortName.Items.Count&nbsp;&gt;&nbsp;0&nbsp;?&nbsp;0&nbsp;:&nbsp;-1;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comboBaudrate.SelectedIndex&nbsp;=&nbsp;comboBaudrate.Items.IndexOf(<span class="string">"9600"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//初始化SerialPort对象</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.NewLine&nbsp;=&nbsp;<span class="string">"/r/n"</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.RtsEnable&nbsp;=&nbsp;<span class="keyword">true</span><span>;</span><span class="comment">//根据实际情况吧。</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//添加事件注册</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.DataReceived&nbsp;+=&nbsp;comm_DataReceived;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">void</span><span>&nbsp;comm_DataReceived(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;SerialDataReceivedEventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(Closing)&nbsp;</span><span class="keyword">return</span><span>;</span><span class="comment">//如果正在关闭，忽略操作，直接返回，尽快的完成串口监听线程的一次循环</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Listening&nbsp;=&nbsp;<span class="keyword">true</span><span>;</span><span class="comment">//设置标记，说明我已经开始处理数据，一会儿要使用系统UI的。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;n&nbsp;=&nbsp;comm.BytesToRead;</span><span class="comment">//先记录下来，避免某种原因，人为的原因，操作几次之间时间长，缓存不一致</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[n];</span><span class="comment">//声明一个临时数组存储当前来的串口数据</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;received_count&nbsp;+=&nbsp;n;<span class="comment">//增加接收计数</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Read(buf,&nbsp;0,&nbsp;n);<span class="comment">//读取缓冲数据</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Clear();<span class="comment">//清除字符串构造器的内容</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//因为要访问ui资源，所以需要使用invoke方式同步ui。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.Invoke((EventHandler)(</span><span class="keyword">delegate</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//判断是否是显示为16禁止</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(checkBoxHexView.Checked)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//依次的拼接出16进制字符串</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>&nbsp;(</span><span class="keyword">byte</span><span>&nbsp;b&nbsp;</span><span class="keyword">in</span><span>&nbsp;buf)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(b.ToString(<span class="string">"X2"</span><span>)&nbsp;+&nbsp;</span><span class="string">"&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//直接按ASCII规则转换成字符串</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(Encoding.ASCII.GetString(buf));&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//追加的形式添加到文本框末端，并滚动到最后。</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.txGet.AppendText(builder.ToString());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//修改接收计数</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labelGetCount.Text&nbsp;=&nbsp;<span class="string">"Get:"</span><span>&nbsp;+&nbsp;received_count.ToString();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}));&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">finally</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Listening&nbsp;=&nbsp;<span class="keyword">false</span><span>;</span><span class="comment">//我用完了，ui可以关闭串口了。</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;buttonOpenClose_Click(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//根据当前串口对象，来判断操作</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(comm.IsOpen)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Closing&nbsp;=&nbsp;<span class="keyword">true</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(Listening)&nbsp;Application.DoEvents();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//打开时点击，则关闭串口</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Close();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Closing&nbsp;=&nbsp;<span class="keyword">false</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//关闭时点击，则设置好端口，波特率后打开</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.PortName&nbsp;=&nbsp;comboPortName.Text;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.BaudRate&nbsp;=&nbsp;<span class="keyword">int</span><span>.Parse(comboBaudrate.Text);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Open();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">catch</span><span>(Exception&nbsp;ex)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//捕获到异常信息，创建一个新的comm对象，之前的不能用了。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;SerialPort();&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//现实异常信息给客户。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(ex.Message);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//设置按钮的状态</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buttonOpenClose.Text&nbsp;=&nbsp;comm.IsOpen&nbsp;?&nbsp;<span class="string">"Close"</span><span>&nbsp;:&nbsp;</span><span class="string">"Open"</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buttonSend.Enabled&nbsp;=&nbsp;comm.IsOpen;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//动态的修改获取文本框是否支持自动换行。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;checkBoxNewlineGet_CheckedChanged(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;txGet.WordWrap&nbsp;=&nbsp;checkBoxNewlineGet.Checked;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;buttonSend_Click(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//定义一个变量，记录发送了几个字节</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;n&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//16进制发送</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(checkBoxHexSend.Checked)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//我们不管规则了。如果写错了一些，我们允许的，只用正则得到有效的十六进制数</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MatchCollection&nbsp;mc&nbsp;=&nbsp;Regex.Matches(txSend.Text,&nbsp;@<span class="string">"(?i)[/da-f]{2}"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;<span class="keyword">byte</span><span>&gt;&nbsp;buf&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;List&lt;</span><span class="keyword">byte</span><span>&gt;();</span><span class="comment">//填充到这个临时列表中</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//依次添加到列表中</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">foreach</span><span>&nbsp;(Match&nbsp;m&nbsp;</span><span class="keyword">in</span><span>&nbsp;mc)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.Add(<span class="keyword">byte</span><span>.Parse(m.Value));&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//转换列表为数组后发送</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Write(buf.ToArray(),&nbsp;0,&nbsp;buf.Count);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//记录发送的字节数</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;buf.Count;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span class="comment">//ascii编码直接发送</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//包含换行符</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(checkBoxNewlineSend.Checked)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.WriteLine(txSend.Text);&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;txSend.Text.Length&nbsp;+&nbsp;2;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span class="comment">//不包含换行符</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm.Write(txSend.Text);&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;txSend.Text.Length;&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send_count&nbsp;+=&nbsp;n;<span class="comment">//累加发送字节数</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labelSendCount.Text&nbsp;=&nbsp;<span class="string">"Send:"</span><span>&nbsp;+&nbsp;send_count.ToString();</span><span class="comment">//更新界面</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;buttonReset_Click(</span><span class="keyword">object</span><span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//复位接受和发送的字节数计数器并更新界面。</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send_count&nbsp;=&nbsp;received_count&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labelGetCount.Text&nbsp;=&nbsp;<span class="string">"Get:0"</span><span>;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labelSendCount.Text&nbsp;=&nbsp;<span class="string">"Send:0"</span><span>;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><textarea cols="86" rows="165" name="code" class="c-sharp" style="display: none; ">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO.Ports;
using System.Text.RegularExpressions;
namespace SerialportSample
{
    public partial class SerialportSampleForm : Form
    {
        private SerialPort comm = new SerialPort();
        private StringBuilder builder = new StringBuilder();//避免在事件处理方法中反复的创建，定义到外面。
        private long received_count = 0;//接收计数
        private long send_count = 0;//发送计数
        private bool Listening = false;//是否没有执行完invoke相关操作
        private bool Closing = false;//是否正在关闭串口，执行Application.DoEvents，并阻止再次invoke
        public SerialportSampleForm()
        {
            InitializeComponent();
        }
        //窗体初始化
        private void Form1_Load(object sender, EventArgs e)
        {
            //初始化下拉串口名称列表框
            string[] ports = SerialPort.GetPortNames();
            Array.Sort(ports);
            comboPortName.Items.AddRange(ports);
            comboPortName.SelectedIndex = comboPortName.Items.Count &gt; 0 ? 0 : -1;
            comboBaudrate.SelectedIndex = comboBaudrate.Items.IndexOf("9600");
            //初始化SerialPort对象
            comm.NewLine = "/r/n";
            comm.RtsEnable = true;//根据实际情况吧。
            //添加事件注册
            comm.DataReceived += comm_DataReceived;
        }
        void comm_DataReceived(object sender, SerialDataReceivedEventArgs e)
        {
            if (Closing) return;//如果正在关闭，忽略操作，直接返回，尽快的完成串口监听线程的一次循环
            try
            {
                Listening = true;//设置标记，说明我已经开始处理数据，一会儿要使用系统UI的。
                int n = comm.BytesToRead;//先记录下来，避免某种原因，人为的原因，操作几次之间时间长，缓存不一致
                byte[] buf = new byte[n];//声明一个临时数组存储当前来的串口数据
                received_count += n;//增加接收计数
                comm.Read(buf, 0, n);//读取缓冲数据
                builder.Clear();//清除字符串构造器的内容
                //因为要访问ui资源，所以需要使用invoke方式同步ui。
                this.Invoke((EventHandler)(delegate
                {
                    //判断是否是显示为16禁止
                    if (checkBoxHexView.Checked)
                    {
                        //依次的拼接出16进制字符串
                        foreach (byte b in buf)
                        {
                            builder.Append(b.ToString("X2") + " ");
                        }
                    }
                    else
                    {
                        //直接按ASCII规则转换成字符串
                        builder.Append(Encoding.ASCII.GetString(buf));
                    }
                    //追加的形式添加到文本框末端，并滚动到最后。
                    this.txGet.AppendText(builder.ToString());
                    //修改接收计数
                    labelGetCount.Text = "Get:" + received_count.ToString();
                }));
            }
            finally
            {
                Listening = false;//我用完了，ui可以关闭串口了。
            }
        }
        private void buttonOpenClose_Click(object sender, EventArgs e)
        {
            //根据当前串口对象，来判断操作
            if (comm.IsOpen)
            {
                Closing = true;
                while (Listening) Application.DoEvents();
                //打开时点击，则关闭串口
                comm.Close();
                Closing = false;
            }
            else
            {
                //关闭时点击，则设置好端口，波特率后打开
                comm.PortName = comboPortName.Text;
                comm.BaudRate = int.Parse(comboBaudrate.Text);
                try
                {
                    comm.Open();
                }
                catch(Exception ex)
                {
                    //捕获到异常信息，创建一个新的comm对象，之前的不能用了。
                    comm = new SerialPort();
                    //现实异常信息给客户。
                    MessageBox.Show(ex.Message);
                }
            }
            //设置按钮的状态
            buttonOpenClose.Text = comm.IsOpen ? "Close" : "Open";
            buttonSend.Enabled = comm.IsOpen;
        }
        //动态的修改获取文本框是否支持自动换行。
        private void checkBoxNewlineGet_CheckedChanged(object sender, EventArgs e)
        {
            txGet.WordWrap = checkBoxNewlineGet.Checked;
        }
        private void buttonSend_Click(object sender, EventArgs e)
        {
            //定义一个变量，记录发送了几个字节
            int n = 0;
            //16进制发送
            if (checkBoxHexSend.Checked)
            {
                //我们不管规则了。如果写错了一些，我们允许的，只用正则得到有效的十六进制数
                MatchCollection mc = Regex.Matches(txSend.Text, @"(?i)[/da-f]{2}");
                List&lt;byte&gt; buf = new List&lt;byte&gt;();//填充到这个临时列表中
                //依次添加到列表中
                foreach (Match m in mc)
                {
                    buf.Add(byte.Parse(m.Value));
                }
                //转换列表为数组后发送
                comm.Write(buf.ToArray(), 0, buf.Count);
                //记录发送的字节数
                n = buf.Count;
            }
            else//ascii编码直接发送
            {
                //包含换行符
                if (checkBoxNewlineSend.Checked)
                {
                    comm.WriteLine(txSend.Text);
                    n = txSend.Text.Length + 2;
                }
                else//不包含换行符
                {
                    comm.Write(txSend.Text);
                    n = txSend.Text.Length;
                }
            }
            send_count += n;//累加发送字节数
            labelSendCount.Text = "Send:" + send_count.ToString();//更新界面
        }
        private void buttonReset_Click(object sender, EventArgs e)
        {
            //复位接受和发送的字节数计数器并更新界面。
            send_count = received_count = 0;
            labelGetCount.Text = "Get:0";
            labelSendCount.Text = "Send:0";
        }
    }
}
</textarea> </p>
<p>&nbsp;</p>
<p>至此，不会再出现关闭死锁问题了。</p>
<p>&nbsp;</p>
<p>希望这篇文章能解你的燃眉之急，非常高兴能与读者分享我层遇到，大多数人都遇到的这个问题。如果说的不明白，欢迎讨论。</p>
<p>后续的有关通讯程序底层设计的文章会讲述一个具有丰富扩展性，但有设计简介的万能通讯库，支持网络、蓝牙、串口通讯、并口通讯。但不要指望我都实现出来了，我只是设计出这个框架。</p>
<p>&nbsp;</p>
<p><a href="http://d.download.csdn.net/down/2369323/wuyazhe">示例代码</a></p>
<p>&nbsp;</p>
<p>//append by wuyazhe @2011-5-26</p>
<p>上面有一点疏漏，源自第一篇，结果到这里还是没修改，源码中有一行，需要修改一下。</p>
<p>//发送按钮中</p>
<p>buf.Add(byte.Parse(m.Value));</p>
<p>要修改为</p>
<p>buf.Add(byte.Parse(m.Value,System.Globalization.NumberStyles.HexNumber));</p>
</div>
<div class="share_buttons" id="sharePanel"><span>分享到：</span> <a name="sina" class="share_sina" title="分享到新浪微博"></a><a name="qq" class="share_qq" title="分享到腾讯微博"></a></div>
<!--192.168.1.236-->
<div class="article_next_prev">
    <li class="prev_article"><span>上一篇：</span><a href="http://blog.csdn.net/wuyazhe/article/details/5598945">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a></li>
    <li class="next_article"><span>下一篇：</span><a href="http://blog.csdn.net/wuyazhe/article/details/5627253">C# 串口操作系列(3) -- 协议篇，二进制协议数据解析</a></li>
</div>


    
</div>
<div id="ad_cen"><iframe id="ad_frm_0" frameborder="0" scrolling="no" style="border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; overflow-x: hidden; overflow-y: hidden; width: 732px; height: 0px; " src="about:blank"></iframe></div>
<script type="text/javascript">
    new Ad(4, 'ad_cen');
</script>
<div id="comment_title" class="panel_head">查看评论<a name="comments"></a></div>
<div id="comment_list"><dl class="comment_item comment_topic" id="comment_item_2471991"><dt class="comment_head" floor="99">99楼 <span class="user"><a class="username" href="http://blog.csdn.net/zyin121" target="_blank">zyin121</a> <span class="ptime">2012-12-17 16:48发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2471991" username="zyin121"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zyin121" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zyin121.jpg" width="40" height="40"></a></dd><dd class="comment_body">看了楼主的文章，获益匪浅啊！一直遇到这个问题，终于知道怎么做了！多谢楼主！</dd></dl><dl class="comment_item comment_topic" id="comment_item_2358910"><dt class="comment_head" floor="98">98楼 <span class="user"><a class="username" href="http://blog.csdn.net/roadno_picklost" target="_blank">roadno_picklost</a> <span class="ptime">2012-09-01 10:14发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2358910" username="roadno_picklost"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/roadno_picklost" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_roadno_picklost.jpg" width="40" height="40"></a></dd><dd class="comment_body">非常感谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_2279653"><dt class="comment_head" floor="97">97楼 <span class="user"><a class="username" href="http://blog.csdn.net/hbf118373052232" target="_blank">hbf118373052232</a> <span class="ptime">2012-07-11 11:13发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2279653" username="hbf118373052232"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/hbf118373052232" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_hbf118373052232.jpg" width="40" height="40"></a></dd><dd class="comment_body">谢谢！</dd></dl><dl class="comment_item comment_topic" id="comment_item_2268163"><dt class="comment_head" floor="96">96楼 <span class="user"><a class="username" href="http://blog.csdn.net/MHTAO0923" target="_blank">MHTAO0923</a> <span class="ptime">2012-06-29 13:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2268163" username="MHTAO0923"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/MHTAO0923" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_mhtao0923.jpg" width="40" height="40"></a></dd><dd class="comment_body">给跪了. 最近玩C#能遇到楼主帖子实乃我的幸运.</dd></dl><dl class="comment_item comment_topic" id="comment_item_2221868"><dt class="comment_head" floor="95">95楼 <span class="user"><a class="username" href="http://blog.csdn.net/wwonesmile" target="_blank">wwonesmile</a> <span class="ptime">2012-05-16 14:02发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2221868" username="wwonesmile"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wwonesmile" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wwonesmile.jpg" width="40" height="40"></a></dd><dd class="comment_body">MK</dd></dl><dl class="comment_item comment_topic" id="comment_item_2204775"><dt class="comment_head" floor="94">94楼 <span class="user"><a class="username" href="http://blog.csdn.net/bcc222" target="_blank">bcc222</a> <span class="ptime">2012-05-04 16:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2204775" username="bcc222"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/bcc222" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_bcc222.jpg" width="40" height="40"></a></dd><dd class="comment_body"><fieldset><legend>引用“FangYANYI”的评论：</legend>好像一直在执行<br>while (Listening)<br>{<br>Application.DoEvents()...</fieldset><br><br><br>我是用代码把所有的事件给删除掉就没有事情了，可以试试！</dd></dl><dl class="comment_item comment_topic" id="comment_item_2146073"><dt class="comment_head" floor="93">93楼 <span class="user"><a class="username" href="http://blog.csdn.net/chenrong980" target="_blank">chenrong980</a> <span class="ptime">2012-03-28 10:01发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2146073" username="chenrong980"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/chenrong980" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_chenrong980.jpg" width="40" height="40"></a></dd><dd class="comment_body">如果是我轮循的发送数据和接收数据呢？我现在关闭窗体整个窗体就会死锁。</dd></dl><dl class="comment_item comment_topic" id="comment_item_2137572"><dt class="comment_head" floor="92">92楼 <span class="user"><a class="username" href="http://blog.csdn.net/lipeng_3g" target="_blank">lipeng_3g</a> <span class="ptime">2012-03-20 13:33发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2137572" username="lipeng_3g"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lipeng_3g" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lipeng_3g.jpg" width="40" height="40"></a></dd><dd class="comment_body">你就是活雷锋啊</dd></dl><dl class="comment_item comment_topic" id="comment_item_2090148"><dt class="comment_head" floor="91">91楼 <span class="user"><a class="username" href="http://blog.csdn.net/FangYANYI" target="_blank">FangYANYI</a> <span class="ptime">2012-02-03 14:41发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2090148" username="FangYANYI"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/FangYANYI" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_fangyanyi.jpg" width="40" height="40"></a></dd><dd class="comment_body">好像一直在执行<br>while (Listening)<br>{<br>Application.DoEvents();<br>}</dd></dl><dl class="comment_item comment_topic" id="comment_item_2090145"><dt class="comment_head" floor="90">90楼 <span class="user"><a class="username" href="http://blog.csdn.net/FangYANYI" target="_blank">FangYANYI</a> <span class="ptime">2012-02-03 14:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2090145" username="FangYANYI"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/FangYANYI" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_fangyanyi.jpg" width="40" height="40"></a></dd><dd class="comment_body">//停止检测<br>        private void tsbStopTest_Click(object sender, EventArgs e)<br>        {<br>            try<br>            {<br>                if (serialPort.IsOpen == true)<br>                {<br>                    Closings = true;<br>                    while (Listening)<br>                    {<br>                        Application.DoEvents();<br>                    }<br>                    serialPort.Close();<br>                    Closings = false;<br>                }<br>                tsbTopLocate.Enabled = false;<br>                MessageBox.Show("端口COM" + UserInfomation.SerElementPort + "被成功关闭");<br>            }<br>            catch (Exception ex)<br>            {<br>                MessageBox.Show("端口关闭失败，" + ex.Message);<br>            }<br>        }</dd></dl><dl class="comment_item comment_topic" id="comment_item_2090144"><dt class="comment_head" floor="89">89楼 <span class="user"><a class="username" href="http://blog.csdn.net/FangYANYI" target="_blank">FangYANYI</a> <span class="ptime">2012-02-03 14:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2090144" username="FangYANYI"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/FangYANYI" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_fangyanyi.jpg" width="40" height="40"></a></dd><dd class="comment_body">我按照你的写了还不行，点关闭等了很长时间没反应，但界面没有卡死。<br>   private void serialPortMailk_DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)<br>        {<br>            if (Closings) return;//如果正在关闭，忽略操作，直接返回，尽快的完成串口监听线程的一次循环<br>            try<br>            {<br>                Listening = true;<br>                byte[] readBuffer = new byte[serialPort.ReadBufferSize];//获取缓冲区数据<br>                serialPort.Read(readBuffer, 0, readBuffer.Length);<br>                string redStr = BasicInfo.ByteArrayToHexString(readBuffer);<br>                this.Invoke(updateText, redStr);<br>            }<br>            catch (Exception ex)<br>            {<br>                MessageBox.Show(ex.Message);<br>            }<br>            finally<br>            {<br>                Listening = false;<br>            }<br>        }</dd></dl><dl class="comment_item comment_topic" id="comment_item_2090098"><dt class="comment_head" floor="88">88楼 <span class="user"><a class="username" href="http://blog.csdn.net/Josslin025" target="_blank">Josslin025</a> <span class="ptime">2012-02-03 14:18发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2090098" username="Josslin025"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/Josslin025" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_josslin025.jpg" width="40" height="40"></a></dd><dd class="comment_body">有了你这样的楼主和分享精神，何愁中国的IT业不强大！？</dd></dl><dl class="comment_item comment_topic" id="comment_item_2079565"><dt class="comment_head" floor="87">87楼 <span class="user"><a class="username" href="http://blog.csdn.net/renshen6" target="_blank">renshen6</a> <span class="ptime">2012-01-12 21:24发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2079565" username="renshen6"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/renshen6" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_renshen6.jpg" width="40" height="40"></a></dd><dd class="comment_body">还是不行，串口封装在dll中，是不是Application.DoEvents();不起作用？</dd></dl><dl class="comment_item comment_topic" id="comment_item_2079560"><dt class="comment_head" floor="86">86楼 <span class="user"><a class="username" href="http://blog.csdn.net/renshen6" target="_blank">renshen6</a> <span class="ptime">2012-01-12 21:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2079560" username="renshen6"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/renshen6" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_renshen6.jpg" width="40" height="40"></a></dd><dd class="comment_body">还是会死，串口程序封装在dll中，是不是调<br>Application.DoEvents();不起作用？</dd></dl><dl class="comment_item comment_topic" id="comment_item_2079558"><dt class="comment_head" floor="85">85楼 <span class="user"><a class="username" href="http://blog.csdn.net/renshen6" target="_blank">renshen6</a> <span class="ptime">2012-01-12 21:21发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2079558" username="renshen6"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/renshen6" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_renshen6.jpg" width="40" height="40"></a></dd><dd class="comment_body">还是没有解决，我的串口程序封装在dll下，Application.DoEvents();是不是不会起作用？</dd></dl><dl class="comment_item comment_topic" id="comment_item_2077748"><dt class="comment_head" floor="84">84楼 <span class="user"><a class="username" href="http://blog.csdn.net/pangtoulili" target="_blank">pangtoulili</a> <span class="ptime">2012-01-11 09:06发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2077748" username="pangtoulili"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/pangtoulili" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_pangtoulili.jpg" width="40" height="40"></a></dd><dd class="comment_body">此贴不顶，情可以堪哪，顶</dd></dl><dl class="comment_item comment_topic" id="comment_item_2076239"><dt class="comment_head" floor="83">83楼 <span class="user"><a class="username" href="http://blog.csdn.net/huige2011" target="_blank">huige2011</a> <span class="ptime">2012-01-09 15:50发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2076239" username="huige2011"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/huige2011" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_huige2011.jpg" width="40" height="40"></a></dd><dd class="comment_body">深深的表示崇拜之情！^-^</dd></dl><dl class="comment_item comment_topic" id="comment_item_2063983"><dt class="comment_head" floor="82">82楼 <span class="user"><a class="username" href="http://blog.csdn.net/lixiao40" target="_blank">lixiao40</a> <span class="ptime">2011-12-27 09:57发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2063983" username="lixiao40"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lixiao40" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lixiao40.jpg" width="40" height="40"></a></dd><dd class="comment_body">问题找到，当关闭的串口再次打开时候，需要 Closing = false;</dd></dl><dl class="comment_item comment_topic" id="comment_item_2063976"><dt class="comment_head" floor="81">81楼 <span class="user"><a class="username" href="http://blog.csdn.net/lixiao40" target="_blank">lixiao40</a> <span class="ptime">2011-12-27 09:48发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2063976" username="lixiao40"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lixiao40" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lixiao40.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主您好：<br>      完全按照您的程序。当第一次打开串口时候接收数据正常，然后关闭串口，第二次再打开串口时候就无法接受到数据了，请问这个问题是怎么引起的呢？</dd></dl><dl class="comment_item comment_topic" id="comment_item_2058542"><dt class="comment_head" floor="80">80楼 <span class="user"><a class="username" href="http://blog.csdn.net/wfcyl" target="_blank">wfcyl</a> <span class="ptime">2011-12-20 16:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2058542" username="wfcyl"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wfcyl" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wfcyl.jpg" width="40" height="40"></a></dd><dd class="comment_body">刚接触串口，不错，很浅显易懂</dd></dl><dl class="comment_item comment_topic" id="comment_item_2050293"><dt class="comment_head" floor="79">79楼 <span class="user"><a class="username" href="http://blog.csdn.net/zpehome" target="_blank">zpehome</a> <span class="ptime">2011-12-13 11:44发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2050293" username="zpehome"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zpehome" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zpehome.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主厉害啊！谢谢分享！</dd></dl><dl class="comment_item comment_topic" id="comment_item_2043447"><dt class="comment_head" floor="78">78楼 <span class="user"><a class="username" href="http://blog.csdn.net/kangguoxing" target="_blank">kangguoxing</a> <span class="ptime">2011-12-07 19:15发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2043447" username="kangguoxing"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/kangguoxing" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_kangguoxing.jpg" width="40" height="40"></a></dd><dd class="comment_body">我根本就没用DataReceived事件，在关闭某些串口时同时会出现长时间无反应</dd></dl><dl class="comment_item comment_topic" id="comment_item_2040275"><dt class="comment_head" floor="77">77楼 <span class="user"><a class="username" href="http://blog.csdn.net/SSS3SUN" target="_blank">SSS3SUN</a> <span class="ptime">2011-12-05 10:44发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2040275" username="SSS3SUN"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/SSS3SUN" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_sss3sun.jpg" width="40" height="40"></a></dd><dd class="comment_body">解决了我的问题了，顶</dd></dl><dl class="comment_item comment_topic" id="comment_item_2028423"><dt class="comment_head" floor="76">76楼 <span class="user"><a class="username" href="http://blog.csdn.net/gougou321" target="_blank">gougou321</a> <span class="ptime">2011-11-22 23:37发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2028423" username="gougou321"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/gougou321" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_gougou321.jpg" width="40" height="40"></a></dd><dd class="comment_body">我在DataReceived事件里面处理一些特定的报文，打个比方，就是5A A5 结束是0A<br>我发到5A A5------没有发0A，一直在等，关闭时候出现异常，怎么不去等直接安全关闭呢？</dd></dl><dl class="comment_item comment_topic" id="comment_item_1948786"><dt class="comment_head" floor="75">75楼 <span class="user"><a class="username" href="http://blog.csdn.net/czcjh11" target="_blank">czcjh11</a> <span class="ptime">2011-09-06 03:08发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1948786" username="czcjh11"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/czcjh11" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_czcjh11.jpg" width="40" height="40"></a></dd><dd class="comment_body">程序提示System.Text.StringBuilder并不包含Clear</dd></dl><dl class="comment_item comment_topic" id="comment_item_1948785"><dt class="comment_head" floor="74">74楼 <span class="user"><a class="username" href="http://blog.csdn.net/czcjh11" target="_blank">czcjh11</a> <span class="ptime">2011-09-06 03:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1948785" username="czcjh11"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/czcjh11" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_czcjh11.jpg" width="40" height="40"></a></dd><dd class="comment_body">是不是不用.NET 4就没办法使用System.Text.StringBuilder.Clear了</dd><dl class="comment_item comment_reply" id="comment_item_2093049"><dt class="comment_head" floor="74">Re: <span class="user"><a class="username" href="http://blog.csdn.net/s_nian" target="_blank">s_nian</a> <span class="ptime">2012-02-07 11:54发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2093049" username="s_nian"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/s_nian" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_s_nian.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复czcjh11：你可以用Remove来代替就可以了，builder.Remove(0, builder.Length );//清除字符串构造器的内容  ，以上是我使用的代码，前两个实例都可以了。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1947214"><dt class="comment_head" floor="73">73楼 <span class="user"><a class="username" href="http://blog.csdn.net/archerxmh" target="_blank">archerxmh</a> <span class="ptime">2011-09-04 15:04发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1947214" username="archerxmh"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/archerxmh" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_archerxmh.jpg" width="40" height="40"></a></dd><dd class="comment_body">老师您好！我有个想法一直没想清楚，为什么串口的事件需要用invoke来处理，而定时器就不需要呢，还请老师解惑</dd><dl class="comment_item comment_reply" id="comment_item_1947342"><dt class="comment_head" floor="73">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2011-09-04 18:44发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1947342" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复archerxmh：DataReveiced事件是另外一个监听线程中执行的。<br>Timer，如果是System.Windows.Forms.Timer这个是中断发消息给消息循环，和ui同一个线程来处理的，不是跨线程，所以不需要。</dd><dl class="comment_item comment_reply" id="comment_item_1947415"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/archerxmh" target="_blank">archerxmh</a> <span class="ptime">2011-09-04 20:28发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1947415" username="archerxmh"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/archerxmh" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_archerxmh.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复wuyazhe：非常感谢，明白了</dd></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1926304"><dt class="comment_head" floor="72">72楼 <span class="user"><a class="username" href="http://blog.csdn.net/liuviking" target="_blank">liuviking</a> <span class="ptime">2011-08-25 14:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1926304" username="liuviking"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/liuviking" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_liuviking.jpg" width="40" height="40"></a></dd><dd class="comment_body">顶礼膜拜！解决了死锁问题！</dd></dl><dl class="comment_item comment_topic" id="comment_item_1871862"><dt class="comment_head" floor="71">71楼 <span class="user"><a class="username" href="http://blog.csdn.net/m398213316" target="_blank">m398213316</a> <span class="ptime">2011-08-11 11:04发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1871862" username="m398213316"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/m398213316" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_m398213316.jpg" width="40" height="40"></a></dd><dd class="comment_body">太不容易了，我程序死锁的问题终于解决了<br>感谢楼主</dd></dl><dl class="comment_item comment_topic" id="comment_item_1870829"><dt class="comment_head" floor="70">70楼 <span class="user"><a class="username" href="http://blog.csdn.net/a1747403411" target="_blank">a1747403411</a> <span class="ptime">2011-08-10 15:17发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1870829" username="a1747403411"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/a1747403411" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_a1747403411.jpg" width="40" height="40"></a></dd><dd class="comment_body">膜拜</dd></dl><dl class="comment_item comment_topic" id="comment_item_1863036"><dt class="comment_head" floor="69">69楼 <span class="user"><a class="username" href="http://blog.csdn.net/shinezhangli" target="_blank">shinezhangli</a> <span class="ptime">2011-08-03 14:51发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1863036" username="shinezhangli"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/shinezhangli" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_shinezhangli.jpg" width="40" height="40"></a></dd><dd class="comment_body">好~~~感谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_1858067"><dt class="comment_head" floor="68">68楼 <span class="user"><a class="username" href="http://blog.csdn.net/zhouyanhui158" target="_blank">zhouyanhui158</a> <span class="ptime">2011-07-29 13:00发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1858067" username="zhouyanhui158"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zhouyanhui158" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zhouyanhui158.jpg" width="40" height="40"></a></dd><dd class="comment_body">受益匪浅！谢谢了~！</dd></dl><dl class="comment_item comment_topic" id="comment_item_1841757"><dt class="comment_head" floor="67">67楼 <span class="user"><a class="username" href="http://blog.csdn.net/chenchug" target="_blank">chenchug</a> <span class="ptime">2011-07-13 10:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1841757" username="chenchug"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/chenchug" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_chenchug.jpg" width="40" height="40"></a></dd><dd class="comment_body">謝謝分享，字字都是金玉良言</dd></dl><dl class="comment_item comment_topic" id="comment_item_1789512"><dt class="comment_head" floor="66">66楼 <span class="user"><a class="username" href="http://blog.csdn.net/a317606001" target="_blank">a317606001</a> <span class="ptime">2011-06-05 15:20发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1789512" username="a317606001"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/a317606001" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_a317606001.jpg" width="40" height="40"></a></dd><dd class="comment_body">好文章，学习了！！</dd></dl><dl class="comment_item comment_topic" id="comment_item_1676808"><dt class="comment_head" floor="65">65楼 <span class="user"><a class="username" href="http://blog.csdn.net/along24" target="_blank">along24</a> <span class="ptime">2011-05-20 16:26发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1676808" username="along24"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/along24" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_along24.jpg" width="40" height="40"></a></dd><dd class="comment_body">我是10次一个循环。循环后发现，全部乱了！这样子的话，怎么修改你的代码？</dd></dl><dl class="comment_item comment_topic" id="comment_item_1676806"><dt class="comment_head" floor="64">64楼 <span class="user"><a class="username" href="http://blog.csdn.net/along24" target="_blank">along24</a> <span class="ptime">2011-05-20 16:25发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1676806" username="along24"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/along24" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_along24.jpg" width="40" height="40"></a></dd><dd class="comment_body">你这几篇文章看后很受益，做了个例子，也很好。现在我要的是主从通信，comm_DataReceived接收来的数据显示在界面上。第一次收到的给textbox1，第二次收到的给textbox2 。。。运行是发现，并不是第一次的给textbox1，有时是textbox2，有时是textbox3。</dd><dl class="comment_item comment_reply" id="comment_item_1678008"><dt class="comment_head" floor="64">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2011-05-22 10:14发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1678008" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 along24：er...<br>这个么。你可以考虑用begininvoke，否则你的执行更新时间较长的。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1657012"><dt class="comment_head" floor="63">63楼 <span class="user"><a class="username" href="http://blog.csdn.net/czk_czk" target="_blank">czk_czk</a> <span class="ptime">2011-04-29 11:03发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1657012" username="czk_czk"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/czk_czk" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_czk_czk.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01] 楼主这个文章写的真是好，多谢啦</dd></dl><dl class="comment_item comment_topic" id="comment_item_1639649"><dt class="comment_head" floor="62">62楼 <span class="user"><a class="username" href="http://blog.csdn.net/fanyun20001" target="_blank">fanyun20001</a> <span class="ptime">2011-04-13 17:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1639649" username="fanyun20001"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/fanyun20001" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_fanyun20001.jpg" width="40" height="40"></a></dd><dd class="comment_body">在mobile6上调串口，关掉后打开程序会死掉“（</dd></dl><dl class="comment_item comment_topic" id="comment_item_1637971"><dt class="comment_head" floor="61">61楼 <span class="user"><a class="username" href="http://blog.csdn.net/wgqq1122" target="_blank">wgqq1122</a> <span class="ptime">2011-04-11 14:11发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1637971" username="wgqq1122"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wgqq1122" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wgqq1122.jpg" width="40" height="40"></a></dd><dd class="comment_body">主要原因就是偶尔进不了DataReceived,经验不多，实在是没办法了，说硬件问题的话超级终端接收还没有问题，RtsEnable = true;ReceivedBytesThreshold=1这种也都试过，完全没有用</dd></dl><dl class="comment_item comment_topic" id="comment_item_1637962"><dt class="comment_head" floor="60">60楼 <span class="user"><a class="username" href="http://blog.csdn.net/wgqq1122" target="_blank">wgqq1122</a> <span class="ptime">2011-04-11 14:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1637962" username="wgqq1122"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wgqq1122" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wgqq1122.jpg" width="40" height="40"></a></dd><dd class="comment_body">没有</dd></dl><dl class="comment_item comment_topic" id="comment_item_1637936"><dt class="comment_head" floor="59">59楼 <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2011-04-11 13:50发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1637936" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">控制台程序是不是已经退出了？</dd></dl><dl class="comment_item comment_topic" id="comment_item_1637925"><dt class="comment_head" floor="58">58楼 <span class="user"><a class="username" href="http://blog.csdn.net/wgqq1122" target="_blank">wgqq1122</a> <span class="ptime">2011-04-11 13:43发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1637925" username="wgqq1122"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wgqq1122" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wgqq1122.jpg" width="40" height="40"></a></dd><dd class="comment_body">重启或者重启vs2005有时就又好了，串口初始化和打开都没问题当事件不触发时关闭串口就会出“System.IO.IOException: 由于线程退出或应用程序请求，已放弃 I/O 操作”。超级终端就一点问题都没有，查阅了些资料说serialport有bug，求高见</dd></dl><dl class="comment_item comment_topic" id="comment_item_1637922"><dt class="comment_head" floor="57">57楼 <span class="user"><a class="username" href="http://blog.csdn.net/wgqq1122" target="_blank">wgqq1122</a> <span class="ptime">2011-04-11 13:42发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1637922" username="wgqq1122"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wgqq1122" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wgqq1122.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主我有个问题请教，DataReceived方法中没有使用invoke调用UI，直接在控制台打印接收的数据,DataReceived事件在打开串口后时而触发时而不触发，不触发时就是憋住了不论等待多长时间（执行DataReceived方法前IsOpen属性也是打开的）</dd></dl><dl class="comment_item comment_topic" id="comment_item_1634636"><dt class="comment_head" floor="56">56楼 <span class="user"><a class="username" href="http://blog.csdn.net/wangqingniat" target="_blank">wangqingniat</a> <span class="ptime">2011-04-07 15:21发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1634636" username="wangqingniat"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wangqingniat" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wangqingniat.jpg" width="40" height="40"></a></dd><dd class="comment_body">DataReceived一般把数据脱壳扔队列，然后由处理线程来处理队列， 你做了太多的事情了[e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1633016"><dt class="comment_head" floor="55">55楼 <span class="user"><a class="username" href="http://blog.csdn.net/djs82" target="_blank">djs82</a> <span class="ptime">2011-04-05 20:56发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1633016" username="djs82"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/djs82" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_djs82.jpg" width="40" height="40"></a></dd><dd class="comment_body">才接触 感谢楼主[e03]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1618683"><dt class="comment_head" floor="54">54楼 <span class="user"><a class="username" href="http://blog.csdn.net/xuguorong" target="_blank">xuguorong</a> <span class="ptime">2011-03-20 11:05发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1618683" username="xuguorong"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/xuguorong" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_xuguorong.jpg" width="40" height="40"></a></dd><dd class="comment_body">非常感谢，高手！</dd></dl><dl class="comment_item comment_topic" id="comment_item_1615341"><dt class="comment_head" floor="53">53楼 <span class="user"><a class="username" href="http://blog.csdn.net/oydg5658" target="_blank">oydg5658</a> <span class="ptime">2011-03-16 10:29发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1615341" username="oydg5658"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/oydg5658" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_oydg5658.jpg" width="40" height="40"></a></dd><dd class="comment_body">恩，不错了啊</dd></dl><dl class="comment_item comment_topic" id="comment_item_1601579"><dt class="comment_head" floor="52">52楼 <span class="user"><a class="username" href="http://blog.csdn.net/liana_z" target="_blank">liana_z</a> <span class="ptime">2011-02-28 10:54发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1601579" username="liana_z"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/liana_z" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_liana_z.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主我想问一下为什么我写了段代码能实现串口之间的基本通讯但是就是串口设置的时候除了串口名有作用其他的都没效果是怎么回事</dd></dl><dl class="comment_item comment_topic" id="comment_item_1593363"><dt class="comment_head" floor="51">51楼 <span class="user"><a class="username" href="http://blog.csdn.net/biaoman" target="_blank">biaoman</a> <span class="ptime">2011-02-16 13:30发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1593363" username="biaoman"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/biaoman" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_biaoman.jpg" width="40" height="40"></a></dd><dd class="comment_body">逍遥兄，我试着用一个只有usb口的单片机向pc传数据，但根据上面代码生成的程序点了open无反应。是因为SerialPort只能接串口进来的数据吗</dd></dl><dl class="comment_item comment_topic" id="comment_item_1539912"><dt class="comment_head" floor="50">50楼 <span class="user"><a class="username" href="http://blog.csdn.net/mohugomohu" target="_blank">mohugomohu</a> <span class="ptime">2010-11-23 16:21发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1539912" username="mohugomohu"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/mohugomohu" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_mohugomohu.jpg" width="40" height="40"></a></dd><dd class="comment_body">事实上，操作窗体控件它都需要Invoke才能使用，我根本就不需要。可是关闭端口的时候还是经常抛异常。</dd><dl class="comment_item comment_reply" id="comment_item_1617984"><dt class="comment_head" floor="50">Re: <span class="user"><a class="username" href="http://blog.csdn.net/GeminiXXXCC" target="_blank">GeminiXXXCC</a> <span class="ptime">2011-03-18 21:45发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1617984" username="GeminiXXXCC"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/GeminiXXXCC" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_geminixxxcc.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 mohugomohu：死锁跟窗体控件其实完全没关系。问题在于SerialPort会创建一个独立的线程来接收数据，而你的关闭端口操作只能放在程序主线程中，所以当你在主线程中关闭端口，而SerialPort创建的线程又在进行通信操作，于是就抛出异常了。</dd><dl class="comment_item comment_reply" id="comment_item_1617990"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/GeminiXXXCC" target="_blank">GeminiXXXCC</a> <span class="ptime">2011-03-18 21:52发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1617990" username="GeminiXXXCC"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/GeminiXXXCC" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_geminixxxcc.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 GeminiXXXCC：呃，说错了，不是死锁，是抛异常和窗体控件没关系..</dd></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1539908"><dt class="comment_head" floor="49">49楼 <span class="user"><a class="username" href="http://blog.csdn.net/mohugomohu" target="_blank">mohugomohu</a> <span class="ptime">2010-11-23 16:16发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1539908" username="mohugomohu"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/mohugomohu" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_mohugomohu.jpg" width="40" height="40"></a></dd><dd class="comment_body">事实上，我把串口操作封装到一个单独的类里面去了，而且根本没有操作窗体的控件，照样死机。</dd><dl class="comment_item comment_reply" id="comment_item_1539932"><dt class="comment_head" floor="49">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-11-23 16:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1539932" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 mohugomohu：要看你死机的原因了。<br>你的异常信息是？</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1528945"><dt class="comment_head" floor="48">48楼 <span class="user"><a class="username" href="http://blog.csdn.net/when_0202" target="_blank">when_0202</a> <span class="ptime">2010-11-09 14:14发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1528945" username="when_0202"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/when_0202" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_when_0202.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01]谢谢lz分享！！</dd></dl><dl class="comment_item comment_topic" id="comment_item_1491833"><dt class="comment_head" floor="47">47楼 <span class="user"><a class="username" href="http://blog.csdn.net/cicigood123" target="_blank">cicigood123</a> <span class="ptime">2010-09-10 14:55发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1491833" username="cicigood123"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/cicigood123" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_cicigood123.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e04]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1489720"><dt class="comment_head" floor="46">46楼 <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-08 08:58发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1489720" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主好！今天捕获到了异常：System.IO.IOException: 由于线程退出或应用程序请求，已放弃 I/O 操作。<br><br>   在 System.IO.Ports.InternalResources.WinIOError(Int32 errorCode, String str)<br>   在 System.IO.Ports.SerialStream.EndWrite(IAsyncResult asyncResult)<br>   在 System.IO.Ports.SerialStream.Write(Byte[] array, Int32 offset, Int32 count, Int32 timeout)<br>   在 System.IO.Ports.SerialPort.Write(Byte[] buffer, Int32 offset, Int32 count)<br>也就是在sp.Write的时候出现了异常，第一次写串口通信程序，有点头大，请楼主赐教！</dd><dl class="comment_item comment_reply" id="comment_item_1489753"><dt class="comment_head" floor="46">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-09-08 09:32发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1489753" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 lanxin775：是不是哪里关闭串口了？</dd><dl class="comment_item comment_reply" id="comment_item_1490165"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-08 15:51发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490165" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：而且我在每次读写之前都会判断串口是否已经打开（sp.IsOpen），确保打开的情况下才去读写，代码如下：<br>       if (sp.IsOpen)<br>            {<br>                sp.DiscardOutBuffer();<br>                sp.DiscardInBuffer();<br>                ……<br>          try<br>                {<br>                    sp.Write(message, 0, message.Length);<br>                    GetResponse(ref response);//读数据<br>                }<br>                catch(Exception e)<br>                {<br>                     throw e;<br>                }<br>       }<br>    else{……}<br>在进行sp.Write的时候出错了</dd><dl class="comment_item comment_reply" id="comment_item_1490193"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-09-08 16:11发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490193" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 lanxin775：刚刷新才看到。<br>你代码写哪里的？DataReceived中么？那里不用判断是否打开的，那个事件是监听线程触发的。而你的错误提示，我分析可能有：硬件问题、比如硬件有特殊协议，你触发导致硬件错误，或是软件某个地方关闭了串口，造成了这里检查是否串口打开的地方，是正常的，但检查后，关闭了。就报错了。</dd><dl class="comment_item comment_reply" id="comment_item_1490252" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-08 16:59发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490252" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：感觉硬件问题的可能性不大，因为每次重新运行都可以正常运行一段时间，并且这个问题是必现的。另外，我是使用timer_Elapsed事件来每隔一定时间实时读取数据并显示的，程序需要一直运行的，关闭串口是在程序退出的时候进行处理的，不知道为什么会出现这个问题？</dd><dl class="comment_item comment_reply" id="comment_item_1490262" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-09-08 17:10发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490262" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 lanxin775：串口相关的问题蛮细节的，我说的硬件意思是某个特殊协议导致硬件、操作系统的驱动层会有些异常。你为什么不用DataReceived处理数据呢？</dd><dl class="comment_item comment_reply" id="comment_item_1490323" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-08 17:56发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490323" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：没有用DataReceived，读数据我用的是ReadByte()，更新UI是使用InvokeRequired 属性和Invoke()方法~</dd></dl></dl></dl></dl></dl><dl class="comment_item comment_reply" id="comment_item_1490145"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-08 15:32发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1490145" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：串口打开后，一直在采集数据，没有关闭，正常运行一段时间后就出现上面的异常~</dd></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1488949"><dt class="comment_head" floor="45">45楼 <span class="user"><a class="username" href="http://blog.csdn.net/lanxin775" target="_blank">lanxin775</a> <span class="ptime">2010-09-06 20:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1488949" username="lanxin775"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lanxin775" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lanxin775.jpg" width="40" height="40"></a></dd><dd class="comment_body">请问楼主个问题：我使用remoting将串口操作发布成服务，然后由winform和webform来调用，调试时运行正常，但是运行一段时间后，大概10几个小时，就会报错：提示由于线程退出或应用程序请求，已放弃I/O请求，请问楼主，能帮忙分析下这个问题吗？谢谢</dd><dl class="comment_item comment_reply" id="comment_item_1488960"><dt class="comment_head" floor="45">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-09-06 20:44发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1488960" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 lanxin775：remoting不懂。。。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1482973"><dt class="comment_head" floor="44">44楼 <span class="user"><a class="username" href="http://blog.csdn.net/mngzilin" target="_blank">mngzilin</a> <span class="ptime">2010-08-27 19:04发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1482973" username="mngzilin"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/mngzilin" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_mngzilin.jpg" width="40" height="40"></a></dd><dd class="comment_body">来看看，挺火爆的场面</dd></dl><dl class="comment_item comment_topic" id="comment_item_1482894"><dt class="comment_head" floor="43">43楼 <span class="user"><a class="username" href="http://blog.csdn.net/xuededaijiaxue" target="_blank">xuededaijiaxue</a> <span class="ptime">2010-08-27 17:01发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1482894" username="xuededaijiaxue"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/xuededaijiaxue" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_xuededaijiaxue.jpg" width="40" height="40"></a></dd><dd class="comment_body">我还有点问题哈~~[e07]<br>就是你发送的字符串的时候，不用转换转换吗？不是串口只接受字节吗（byte），而且发送汉字的话是收不到的。接收的数据能用“builder.Append(Encoding.ASCII.GetString(buf));”吗？我以前用这个接收的时候发送汉字就会出现乱码~我用的是“System.Text.Encoding.Default.GetString(data);”这样才能接收到汉字~</dd><dl class="comment_item comment_reply" id="comment_item_1482902"><dt class="comment_head" floor="43">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-27 17:12发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1482902" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 xuededaijiaxue：设置SerialPort的Encoding属性为Encoding.GetEncoding(936)。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1480419"><dt class="comment_head" floor="42">42楼 <span class="user"><a class="username" href="http://blog.csdn.net/xuededaijiaxue" target="_blank">xuededaijiaxue</a> <span class="ptime">2010-08-24 18:18发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1480419" username="xuededaijiaxue"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/xuededaijiaxue" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_xuededaijiaxue.jpg" width="40" height="40"></a></dd><dd class="comment_body">在实际的应用中很少，但是要是你不停的按打开关闭串口就会了~~我有点想用优先级的做法，就是不知道该怎么做~~能不能给我指点一下迷津啊~~呵呵~~~[e01][e01]</dd><dl class="comment_item comment_reply" id="comment_item_1480446"><dt class="comment_head" floor="42">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-24 19:06发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1480446" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 xuededaijiaxue：虽然不会经常的打开关闭串口，但你要知道，这种可能偶然发生，在客户那里也是很麻烦的，客户会认为是一个不稳定的软件。<br>和优先级没关系，这是死锁。</dd><dl class="comment_item comment_reply" id="comment_item_1480724"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/xuededaijiaxue" target="_blank">xuededaijiaxue</a> <span class="ptime">2010-08-25 09:48发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1480724" username="xuededaijiaxue"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/xuededaijiaxue" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_xuededaijiaxue.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：我的意思是，死锁是2个线程抢占资源，我是想让窗体执行关闭串口的线程的优先级比委托的那个线程低一点，这样当执行关闭的时候，它不是要去考虑委托的线程，如果委托的线程的还没有运行完，而而优先级机没有委托的高，它就回排在委托的后面，等待委托这个线程执行完，才会执行自己的线程？~<br>我的这个想法行不通吗？？~~[e07]</dd><dl class="comment_item comment_reply" id="comment_item_1480739"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-25 09:58发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1480739" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 xuededaijiaxue：<br>这个文章所描述的问题就是死锁。大家偶然发生的关闭卡住就是死锁。<br><br>两个线程如下：<br>UI-&amp;gt;Close-&amp;gt;WaitSingelObject(-1)等待监听循环一次结束，如果不结束，则UI的比如按钮，执行的Close就会阻塞在这里无限等待，无限等待是系统写死的，你无法设置关闭的超时退出。<br>监听线程<br>while(IsOpen)<br>{<br>    WaitSingelObject(waitobject,-1)//一直等待<br>   //api读串口缓冲区并去除错误数据<br>   DataReceived(....)//这里执行了事件<br>}<br><br>而设计本身没问题，但是DataReceived如果此时在访问界面资源，因为.net的线程同步方式是Invoke/BeginInvoke前者是SendMessage实现的，那么要求立刻返回结果，但按钮正在按下，所以SendMessage需要等待Close的那个按钮结束，那个按钮需要等待DataReceived结束，DataReceived中的UI线程同步又反过来需要等待当前UI界面操作结束(Close的调用地方，比如按钮）。<br>这个过程不是总会发生，但偶然的一旦发生，就会死锁。就是本文介绍的情况。这个情况很偶然，但你想想，不论死锁双方的优先级如何，都是无法解除死锁的，只能入上面给的方法，避免死锁的发生。</dd></dl></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1477963"><dt class="comment_head" floor="41">41楼 <span class="user"><a class="username" href="http://blog.csdn.net/wangshiwei1105" target="_blank">wangshiwei1105</a> <span class="ptime">2010-08-20 21:20发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1477963" username="wangshiwei1105"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wangshiwei1105" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wangshiwei1105.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01]传说中的牛人<br>黑猫白猫解决问题的就是好程序。说得再好不给出讲解，没有示例都是空谈，证明不了什么。<br>向LZ学习，解决问题给方法给示例。</dd></dl><dl class="comment_item comment_topic" id="comment_item_1472600"><dt class="comment_head" floor="40">40楼 <span class="user"><a class="username" href="http://blog.csdn.net/faunkyou" target="_blank">faunkyou</a> <span class="ptime">2010-08-13 09:14发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1472600" username="faunkyou"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/faunkyou" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_faunkyou.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主，你这样会有问题吧，在： int n = comm.BytesToRead;//先记录下来，避免某种原因，人为的原因，操作几次之间时间长，缓存不一致  这一句话中的n能够一次性获取comm的BytesToRead吗？如果comm端口的BytesToRead很小的话是没问题的，但是如果很大的话，这一下子是读不完的，我现在遇到的问题就是这样的。在如下页面中：http://topic.csdn.net/u/20100812/09/14928d81-725b-4104-ab61-7c7936de0eca.html?seed=801760377&amp;amp;r=67659570#r_67659570</dd><dl class="comment_item comment_reply" id="comment_item_1472622"><dt class="comment_head" floor="40">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-13 09:36发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1472622" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 faunkyou：这是肯定的，这个BytesToRead的功能不是读数据，只是调用api获得硬件读缓冲区有效数据长度，调用ClearCommError去掉错误数据，从软件上是稳定的，从硬件上，会有可能模拟数据转换数字的时候产生某些错误，这个返回的是有效数据长度，不会错误的。你帖子的问题与这个无关的。你的代码上看。你没有缓存过数据，串口是流设备，不是你想象的一次就得到所有数据，而是一段一段传输的，接收不完整的时候，你需要缓存，你可以看看后面的几篇有关数据解析的。你帖子问题到你帖子里继续讨论了。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1470280"><dt class="comment_head" floor="39">39楼 <span class="user"><a class="username" href="http://blog.csdn.net/weixiangqi" target="_blank">weixiangqi</a> <span class="ptime">2010-08-10 17:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1470280" username="weixiangqi"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/weixiangqi" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_weixiangqi.jpg" width="40" height="40"></a></dd><dd class="comment_body">大哥我怎么测试了，多没有接收到任何信息啊！</dd><dl class="comment_item comment_reply" id="comment_item_1470289"><dt class="comment_head" floor="39">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-10 17:31发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1470289" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 weixiangqi：怎么测试的？</dd><dl class="comment_item comment_reply" id="comment_item_1515449"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/player599zxm" target="_blank">player599zxm</a> <span class="ptime">2010-10-21 10:18发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1515449" username="player599zxm"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/player599zxm" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_player599zxm.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：是不是需要硬件设备,才可以测试啊</dd></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1470035"><dt class="comment_head" floor="38">38楼 <span class="user"><a class="username" href="http://blog.csdn.net/euler_yang" target="_blank">euler_yang</a> <span class="ptime">2010-08-10 13:27发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1470035" username="euler_yang"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/euler_yang" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_euler_yang.jpg" width="40" height="40"></a></dd><dd class="comment_body">请问楼主：<br>先碰到如下问题<br>执行方法.open()的时候<br>“由于线程退出或应用程序请求，已放弃I/O操作”</dd><dl class="comment_item comment_reply" id="comment_item_1470050"><dt class="comment_head" floor="38">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-08-10 13:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1470050" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 euler_yang：你试试其他串口工具，看硬件是否正常。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1468314"><dt class="comment_head" floor="37">37楼 <span class="user"><a class="username" href="http://blog.csdn.net/zpj881" target="_blank">zpj881</a> <span class="ptime">2010-08-07 18:58发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1468314" username="zpj881"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zpj881" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zpj881.jpg" width="40" height="40"></a></dd><dd class="comment_body">正好碰上，非常感谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_1462430"><dt class="comment_head" floor="36">36楼 <span class="user"><a class="username" href="http://blog.csdn.net/caijianfa" target="_blank">caijianfa</a> <span class="ptime">2010-07-30 15:48发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1462430" username="caijianfa"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/caijianfa" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_caijianfa.jpg" width="40" height="40"></a></dd><dd class="comment_body">lz你好你说的死锁，我好像都没怎么遇到啊~~~~当发送/接受“大量”消息时，同时关闭串口，传送/接收的消息在txtbox中只显示一部分消息，在存储在内存中的消息并没有全部传完。这是正常的吗？</dd><dl class="comment_item comment_reply" id="comment_item_1462484"><dt class="comment_head" floor="36">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-07-30 16:32发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1462484" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 caijianfa：死锁不是100%的。偶然发生。几率也不算很小。如果大量测试，每天都能遇到几次。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1458109"><dt class="comment_head" floor="35">35楼 <span class="user"><a class="username" href="http://blog.csdn.net/wsxzz_2008" target="_blank">wsxzz_2008</a> <span class="ptime">2010-07-25 15:29发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1458109" username="wsxzz_2008"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wsxzz_2008" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wsxzz_2008.jpg" width="40" height="40"></a></dd><dd class="comment_body">请问一下，如何实现当接收到特定的信号时候，改变界面上标签显示的值，同时关闭串口？？？</dd><dl class="comment_item comment_reply" id="comment_item_1458127"><dt class="comment_head" floor="35">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-07-25 15:54发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1458127" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wsxzz_2008：这个例子本身就是收到数据更新界面了。如果你需要，DataReceived方法之外阻止再次执行，然后执行Serial.Close()就可以了。后续的有一篇介绍文本协议分析和二进制协议分析的。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1439732"><dt class="comment_head" floor="34">34楼 <span class="user"><a class="username" href="http://blog.csdn.net/hanghang0307" target="_blank">hanghang0307</a> <span class="ptime">2010-07-06 11:26发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1439732" username="hanghang0307"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/hanghang0307" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_hanghang0307.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e03]<br>很有用，谢谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_1428326"><dt class="comment_head" floor="33">33楼 <span class="user"><a class="username" href="http://blog.csdn.net/o0oo0ooo0" target="_blank">o0oo0ooo0</a> <span class="ptime">2010-06-25 10:23发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1428326" username="o0oo0ooo0"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/o0oo0ooo0" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_o0oo0ooo0.jpg" width="40" height="40"></a></dd><dd class="comment_body">关于serialport之bug：<br>现在新的电脑很少自带串口，绝大多都用USB转串口，非常方便，我用C#的serialport类<br>做通信的处理，不过很快发现作微软的产品，此类有存在重大bug的嫌疑（是否微软好的东西都是买来的呢？）<br>过程很简单：<br>1。定义串口对象并打开：SerialPort serialPort1 = new SerialPort();<br>                       serialPort1.Open();<br>2。拔掉串口设备（USB转串口线）问题即出现：我的应用软件无法正常退出，退出时会抛出无法try-catch掉的<br>   UnauthorizedAccessException 异常                      <br><br>无法catch是因为它在 Application.Run（...）之后的Main（）{...}结束之后发生<br>也就是在本进程最后Exit之时，回收站GC的工人阿姨多少有点好奇地跑到进程原来所占<br>的领地看看一切是否收拾妥当（特别是非托管的资源，照理不关GC的事），结果发现串口<br>的灯还亮着，“噫?!,人都走了还不关灯，哎！现在的年轻人啊”，于是跑过去想把它关了，<br>但意外的是居然关不了，“怪了，什么东东啊，不能关,还没权力？我可是中央派来的哦，切!...”<br><br>有个办法是用GC.SuppressFinalize告诉回收站不要去管这闲事，但没用，可能真不是GC�</dd><dl class="comment_item comment_reply" id="comment_item_1618123"><dt class="comment_head" floor="33">Re: <span class="user"><a class="username" href="http://blog.csdn.net/arofree" target="_blank">arofree</a> <span class="ptime">2011-03-19 09:10发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1618123" username="arofree"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/arofree" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_arofree.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 o0oo0ooo0：拔掉USB会出现驱动层的问题，这个应用层肯定会有问题的，应该很难搞</dd></dl><dl class="comment_item comment_reply" id="comment_item_1428490"><dt class="comment_head" floor="33">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-06-25 12:39发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1428490" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 o0oo0ooo0：这种错误操作，用户也能理解的。</dd><dl class="comment_item comment_reply" id="comment_item_1428844"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-06-25 16:41发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1428844" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：<br>谢谢wuyazhe的回复<br>后面还有一句怎么没显示出来呢？，就是退出的时候掉用SerialPort.Close(),SerialPort.Dispose()不起作用；USB串口设备的这种拔插操作在QC测试，用户端评估是经常性的，软件弹出系统错误提示会给人软件有问题的质疑，自己也不太能接受，不知大家是否遇到，是怎么处理的呢</dd><dl class="comment_item comment_reply" id="comment_item_1428929"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-06-25 17:18发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1428929" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：尝试注册AppDomain.CurrentDomain.UnhandledException事件，忽略掉异常或软件提示。看能否捕获到，我不确定，你要试试。</dd></dl></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1415665"><dt class="comment_head" floor="32">32楼 <span class="user"><a class="username" href="http://blog.csdn.net/lianxiwang2008" target="_blank">lianxiwang2008</a> <span class="ptime">2010-06-12 15:08发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1415665" username="lianxiwang2008"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/lianxiwang2008" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_lianxiwang2008.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01][e01][e01]<br>楼主好厉害奥</dd></dl><dl class="comment_item comment_topic" id="comment_item_1399312"><dt class="comment_head" floor="31">31楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-29 18:03发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399312" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主,对你上面的程序还有个疑问,就是除了初始化Closing = false,其他地方就没有false;一旦关闭串口完成后这个也没有地方变为ｆａｌｓｅ的么?</dd><dl class="comment_item comment_reply" id="comment_item_1399325"><dt class="comment_head" floor="31">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-29 18:26发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399325" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>看的仔细。呵呵。下载的例子中因该有恢复的<br>comm.Close();  <br>后面应该恢复一下<br>Closing = false;[e03]</dd><dl class="comment_item comment_reply" id="comment_item_1399332"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-29 18:33发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399332" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：我自学Ｃ#才几个月,以前没有高级语言基础,我在偷你的源码,调试中才发现的,要是光看,哪里看得出来!以后有问题还请不吝赐教!</dd><dl class="comment_item comment_reply" id="comment_item_1399358"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-29 18:57发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399358" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：^_^，欢迎下载。需要讨论可以发邮件：<br>wuyazhe@yeah.net<br>或是qq:32610303</dd></dl></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1399288"><dt class="comment_head" floor="30">30楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-29 17:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399288" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主你好!我有个弱弱的问题请教下!我做和单片机通信的一个程序,单片机发出来的数据差不多是４byte/50us,通信我采用的ＵＳＢ转串口的线ＵＴ-８８０,baudrate是921600,发过来的是的１６进制,我要进行处理并显示,这么快的传输速度,datareceive应该怎么处理,receivedbytethreshold设置成２计算机会怎样呢!计算机响应有问题么? 请赐教!</dd><dl class="comment_item comment_reply" id="comment_item_1399298"><dt class="comment_head" floor="30">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-29 17:52发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1399298" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：的确好快哦，115200的8倍速度。你这个程序处理了数据后需要更新界面的么？还是写文件？ReceivedByteThreshold设置为1就可以了。你尝试用sscomm32.exe看数据是否会丢，如果数据会丢，可能硬件要尝试修改，如果不丢，软件这块看我这个系列的第三章，应该是效率可以满足的。如果频繁更新界面，那可能跟不上，也看电脑了，按前面的朋友说的beginInvoke方式更新界面试试。你可以看看我的第三章内容，就具体问题我们分析一下。<br><br>C# 串口操作系列(3) -- 协议篇，二进制协议数据解析<br>http://blog.csdn.net/wuyazhe/archive/2010/05/27/5627253.aspx</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1398796"><dt class="comment_head" floor="29">29楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-29 03:19发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1398796" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主太厉害了, 这两天正在写串口程序, 太受用了! 谢谢楼主! 以后有问题一定请教![e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1395045"><dt class="comment_head" floor="28">28楼 <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-26 16:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1395045" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">呼呼，偷懒好久了。继续写下一篇，协议分析篇</dd></dl><dl class="comment_item comment_topic" id="comment_item_1395006"><dt class="comment_head" floor="27">27楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 15:47发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1395006" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">不判断，我就不能显示，只有等接收到结束符0a，我才发送吓一条命令</dd></dl><dl class="comment_item comment_topic" id="comment_item_1394874"><dt class="comment_head" floor="26">26楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 14:43发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394874" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">byte[] buf = new byte[n];  <br>           received_count += n;//增加接收计数   <br>           comm.Read(buf, 0, n);//读取缓冲数据 <br>           if(确定接收完数据比如长度和结束位都符合) <br>           {    <br>              this.Invoke((EventHandler)(delegate  <br>                    {   <br>                       //更新数据<br>                    })); <br>                   Listening = false; <br>                } <br>            }</dd><dl class="comment_item comment_reply" id="comment_item_1394924"><dt class="comment_head" floor="26">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-26 15:10发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394924" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>不应该判断。任何时候，进入DataReceived的时候就设置Listening为true，离开（比如return)的时候，就设置为false</dd><dl class="comment_item comment_reply" id="comment_item_1395064"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 16:17发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1395064" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：那您的意思是不管数据接收完与否，都要在程序结束处设置成false，也就是在判断语句外面。</dd><dl class="comment_item comment_reply" id="comment_item_1395139"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-26 16:52发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1395139" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：linstening的目的是互斥是否在监听状态，和数据的逻辑性无关。不论你数据是否发完整，我们关闭串口操作都不影响，不是么？</dd><dl class="comment_item comment_reply" id="comment_item_1395327" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 18:31发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1395327" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：是，谢谢，我懂了。</dd></dl></dl></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1394873"><dt class="comment_head" floor="25">25楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 14:43发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394873" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">我有个疑问：我的程序大概是这样<br>void comm_DataReceived(object sender, SerialDataReceivedEventArgs e)   <br>        {   <br>        try  <br>            {   <br>                Listening = true;   <br>           int n = comm.BytesToRead;</dd></dl><dl class="comment_item comment_topic" id="comment_item_1394860"><dt class="comment_head" floor="24">24楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 14:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394860" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">方程序怎么放不上去啊？</dd><dl class="comment_item comment_reply" id="comment_item_1394920"><dt class="comment_head" floor="24">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-26 15:09发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394920" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>http://d.download.csdn.net/down/2369323/wuyazhe</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1394856"><dt class="comment_head" floor="23">23楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 14:35发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394856" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">楼主，我也遇到同样的问题。我的是确定接收完Listening = false;因为有时候接收两次才接受完，所以会不会在我关闭串口时Listening不是false？那我应该把它放在哪？紧急求助！谢谢楼主</dd><dl class="comment_item comment_reply" id="comment_item_1394916"><dt class="comment_head" floor="23">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-26 15:06发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394916" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：和你多少次执行DataReceive后数据才完整无关，这只是一次数据处理的，完整不完整无所谓，数据收到后需要缓存才可以分析，不缓存的方式不稳定。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1394855"><dt class="comment_head" floor="22">22楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-26 14:34发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1394855" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1393626"><dt class="comment_head" floor="21">21楼 <span class="user"><a class="username" href="http://blog.csdn.net/jay80301" target="_blank">jay80301</a> <span class="ptime">2010-05-25 17:01发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1393626" username="jay80301"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/jay80301" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_jay80301.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e03][e03][e03][e01][e01][e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1392882"><dt class="comment_head" floor="20">20楼 <span class="user"><a class="username" href="http://blog.csdn.net/mlhy20060406" target="_blank">mlhy20060406</a> <span class="ptime">2010-05-25 09:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1392882" username="mlhy20060406"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/mlhy20060406" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_mlhy20060406.jpg" width="40" height="40"></a></dd><dd class="comment_body">学习了，谢谢了[e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1392749"><dt class="comment_head" floor="19">19楼 <span class="user"><a class="username" href="http://blog.csdn.net/womlly2008" target="_blank">womlly2008</a> <span class="ptime">2010-05-25 01:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1392749" username="womlly2008"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/womlly2008" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_womlly2008.jpg" width="40" height="40"></a></dd><dd class="comment_body">学习了,谢谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_1392346"><dt class="comment_head" floor="18">18楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-24 17:34发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1392346" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e08][e01][e02][e03][e04][e05][e06][e07][e08][e10]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1392175"><dt class="comment_head" floor="17">17楼 <span class="user"><a class="username" href="http://blog.csdn.net/chenyx_message" target="_blank">chenyx_message</a> <span class="ptime">2010-05-24 15:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1392175" username="chenyx_message"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/chenyx_message" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_chenyx_message.jpg" width="40" height="40"></a></dd><dd class="comment_body">标记，学习！~~</dd></dl><dl class="comment_item comment_topic" id="comment_item_1391665"><dt class="comment_head" floor="16">16楼 <span class="user"><a class="username" href="http://blog.csdn.net/kakajay008" target="_blank">kakajay008</a> <span class="ptime">2010-05-24 09:15发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1391665" username="kakajay008"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/kakajay008" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_kakajay008.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01][e01][e01][e01]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1391637"><dt class="comment_head" floor="15">15楼 <span class="user"><a class="username" href="http://blog.csdn.net/server126" target="_blank">server126</a> <span class="ptime">2010-05-24 08:54发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1391637" username="server126"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/server126" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_server126.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e03][e03][e03][e03][e03]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1391393"><dt class="comment_head" floor="14">14楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-23 19:33发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1391393" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e04]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1390587"><dt class="comment_head" floor="13">13楼 <span class="user"><a class="username" href="http://blog.csdn.net/q290432383" target="_blank">q290432383</a> <span class="ptime">2010-05-22 15:58发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1390587" username="q290432383"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/q290432383" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_q290432383.jpg" width="40" height="40"></a></dd><dd class="comment_body">注释的很清楚，虽然我基本不用到，支持这样的传码方式</dd></dl><dl class="comment_item comment_topic" id="comment_item_1390291"><dt class="comment_head" floor="12">12楼 <span class="user"><a class="username" href="http://blog.csdn.net/euler_yang" target="_blank">euler_yang</a> <span class="ptime">2010-05-22 10:22发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1390291" username="euler_yang"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/euler_yang" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_euler_yang.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e03]楼主研究的这么深。我以前使用try来屏蔽异常。但还是会出现莫名其妙的退出程序。问题应该就是你所讲解的部分。好好研究下。谢谢</dd></dl><dl class="comment_item comment_topic" id="comment_item_1389814"><dt class="comment_head" floor="11">11楼 <span class="user"><a class="username" href="http://blog.csdn.net/pawys" target="_blank">pawys</a> <span class="ptime">2010-05-21 18:07发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1389814" username="pawys"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/pawys" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_pawys.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e04]</dd></dl><dl class="comment_item comment_topic" id="comment_item_1389805"><dt class="comment_head" floor="10">10楼 <span class="user"><a class="username" href="http://blog.csdn.net/sytu_hzj" target="_blank">sytu_hzj</a> <span class="ptime">2010-05-21 18:00发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1389805" username="sytu_hzj"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/sytu_hzj" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_sytu_hzj.jpg" width="40" height="40"></a></dd><dd class="comment_body">串口本来就是串行通讯，对于一个串口来说，搞并发根本就没有意义。<br>串口通信本很简单，只要上位机和下位机配合好即可（明确公司内部的通信协议），本人用C#做了三年串口通信，心情烦躁没看完你的代码，随便瞎说说！</dd><dl class="comment_item comment_reply" id="comment_item_1389832"><dt class="comment_head" floor="10">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-21 18:23发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1389832" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 sytu_hzj：<br>你用c#做了3年的串口通讯还不知道串口是独立一个监听线程来操作的么？<br>监听线程分析数据后和主界面之间的显示切换，如果你3年做的都是数据量不大的，你不会遇到这个问题的，如果是gps，100%会并发的，1秒最多有1200多个字节的数据，你直接关闭，死锁的几率很大的。</dd><dl class="comment_item comment_reply" id="comment_item_2207624"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/werewofe" target="_blank">werewofe</a> <span class="ptime">2012-05-07 17:38发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2207624" username="werewofe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/werewofe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_werewofe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复wuyazhe：支持楼主</dd></dl><dl class="comment_item comment_reply" id="comment_item_1420754"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/sytu_hzj" target="_blank">sytu_hzj</a> <span class="ptime">2010-06-18 10:41发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1420754" username="sytu_hzj"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/sytu_hzj" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_sytu_hzj.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：1S多少个数据是根据波特率来的，你连波特率都不算，说个屁</dd><dl class="comment_item comment_reply" id="comment_item_2214373"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2012-05-13 20:42发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2214373" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复sytu_hzj：才看到这回复，看来是没看懂我写的，我说的1200个字节，没说波特率，没错，因为的确和波特率无关，只是说包长度，波特率自然要选择一个合适的波特率，否则丢数据。<br>9600波特率，1秒：1起始位，1停止位，8位数据，理论峰值960字节，1200个字节的话，最少19200波特率，这根本和波特率是无关的。才看到，蛋疼回复一下。</dd></dl><dl class="comment_item comment_reply" id="comment_item_1601259"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/netskl2423" target="_blank">netskl2423</a> <span class="ptime">2011-02-27 19:32发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1601259" username="netskl2423"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/netskl2423" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_netskl2423.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 sytu_hzj：有意义吗，人家按默认9600波特率算呗，强词夺理</dd></dl></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1388555"><dt class="comment_head" floor="9">9楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-20 19:51发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1388555" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">不应该使用DataReceived事件,一开始就选错方法了<br>SerialPort串口还有其他致命的bug,跟.net framework相关<br>你这样做只不过是碰到死耗子而已</dd><dl class="comment_item comment_reply" id="comment_item_2207628"><dt class="comment_head" floor="9">Re: <span class="user"><a class="username" href="http://blog.csdn.net/werewofe" target="_blank">werewofe</a> <span class="ptime">2012-05-07 17:41发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="2207628" username="werewofe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/werewofe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_werewofe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复匿名用户：讨厌自命清高的人，有本事也像楼主这样，给大家做个平台</dd></dl><dl class="comment_item comment_reply" id="comment_item_1389114"><dt class="comment_head" floor="9">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-21 11:09发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1389114" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：讨论问题就拿出实例和证据，放两句就走没意义！显得自己多高明！</dd><dl class="comment_item comment_reply" id="comment_item_1389299"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-21 13:12发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1389299" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：无知小儿,多写几年代码,就会明白我说什么了</dd><dl class="comment_item comment_reply" id="comment_item_1472596"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/faunkyou" target="_blank">faunkyou</a> <span class="ptime">2010-08-13 09:11发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1472596" username="faunkyou"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/faunkyou" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_faunkyou.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：你们这样的人是不利于我国软件行业的进步的。[e08]</dd></dl></dl></dl><dl class="comment_item comment_reply" id="comment_item_1388614"><dt class="comment_head" floor="9">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 20:58发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1388614" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>那你举出其他bug吧。呵呵。<br>碰死耗子？你的意思是我这样是降低了死锁几率，还是会死锁么？我用这个方法1年多，客户超过20000，貌似没有出现关不掉的情况，你可以阐述一下这个死锁的原因，至于serialport不好么，这个类是可以跨平台的，wince,mobile,ppc,windows都可以支持，自己做一个是可以的，但你实际的在wince设备上测试一个很通用的貌似不容易，我用过很多操作串口封装的类，有些系统不通用，莫名其妙出问题，serialport倒是很稳定。<br>接受批评和讨论，但请给出适当的理由，例如zju3020912063所说的BeginInvoke方法，这个我要实际的测试一下，如果BeginInvoke是消息方式实现的，可能可以，要回头测试。<br>说不定用BeginInvoke就可以更容易的解决这个问题。<br><br>至于这篇文章的意义，我开头说过了。如果你认为这是碰巧。那的确巧合的解决了所遇到这个问题的朋友的问题，不论是身边的，还是网友。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1387791"><dt class="comment_head" floor="8">8楼 <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:37发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387791" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">窗口用的IO线程是专门的IO线程池，在xp以上的系统是用IOCP实现的，所以这些事件回调函数不能有被block住的操作，最好不要和其他线程同步，不要访问其他IO资源，当然纯粹计算复杂半天出不来结果没关系。否则会影响线程池性能。</dd><dl class="comment_item comment_reply" id="comment_item_1387793"><dt class="comment_head" floor="8">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:37发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387793" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：修正 窗口用的IO线程是专门的IO线程池 是<br>串口用的IO线程是专门的IO线程池</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1387559"><dt class="comment_head" floor="7">7楼 <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 09:50发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387559" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">太笨了，不知道有个beginInvoke方法么，不会等待界面线程返回的。如果你不关心函数的返回值，连EndInvoke都不用调。直接给主线程发个通知就完事了。</dd><dl class="comment_item comment_reply" id="comment_item_1387638"><dt class="comment_head" floor="7">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 10:26发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387638" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：<br>BeginInvoke可能在这里会有一点问题。你如果不缓存数据，UI和串口相比，UI是要处理某些消息可能会慢的，串口数据会快，可能执行了2次BeginInvoke的时候，第一次的还没完成，导致显示数据的混乱，如果缓存了数据，BeginInvoke是要访问缓存数据的，也要进行同步。把一个2线程操作的问题变成更多的并发操作可能不会简化，反而会让这个执行序列更复杂。</dd></dl><dl class="comment_item comment_reply" id="comment_item_1387604"><dt class="comment_head" floor="7">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zady" target="_blank">zady</a> <span class="ptime">2010-05-20 10:10发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387604" username="zady"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zady" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zady.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：<br>[e03]呵，正想说这句。<br><br>另外，通常不大好在象DataReceived这种系统管理的线程中做太多的事，一般只是实现会话层以及把数据脱壳后扔队列，然后由另外的数据处理线程来处理队列，这当中就包括用BeginInvoke来处理UI。</dd><dl class="comment_item comment_reply" id="comment_item_1387647"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 10:30发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387647" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zady：<br>是的，尽量在DataReceived中少做一些，可以把数据分析和更新放在主线程来做。这样外设操作会更高效。但这样就需要DataReceived中发送消息给主程序，主程序有空时候，同步缓存后，分析显示，这样效率最高。而且也能避免死锁的发生。</dd><dl class="comment_item comment_reply" id="comment_item_1387764"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:25发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387764" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：BeginInvoke是用窗口消息队列模拟的，你有空看看window编程，没听说过消息投递顺序会被打乱，会乱的是一些高优先级系统消息，beginInvoke应该是用一自定义消息实现的，所以不可能被系统打乱顺序。这不是网络，不要混淆概念。</dd><dl class="comment_item comment_reply" id="comment_item_1387805" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 11:45发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387805" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：<br>控件的BeginInvoke是发消息方式实现的，原来如此，之前看到讨论说异步委托的实现原理是多线程，就没有深究了。线程也差不多。但是如果不是控件的，而是Delegate的BeginInvoke呢？这就肯定不是消息方式了。</dd><dl class="comment_item comment_reply" id="comment_item_1387822" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:53发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387822" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 wuyazhe：一样是消息，每个类创建的时候，都记得创建自己的线程，BeginInvoke就是给创建自己的线程发消息开始一个异步调用，线程消息其实和窗口消息没什么区别，窗口消息只不过是线程接到消息后再分发而已，这个动作在每个win程序的主循环里都有。</dd></dl></dl><dl class="comment_item comment_reply" id="comment_item_1387773" style="margin-left:0;"><dt class="comment_head" floor="1">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:29发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387773" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：会乱的消息我知道的只有WM_TIMER这个是低优先，只要有其他消息就会被推后。一个WM_QUIT这个是高优先，一进入队列就插队到最前方。</dd><dl class="comment_item comment_reply" id="comment_item_1387779" style="margin-left:0;"><dt class="comment_head" floor="2">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 11:31发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387779" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：还有WM_PAINT这个是只要队列里有这个消息，后来的全部被丢弃。</dd></dl></dl></dl></dl></dl><dl class="comment_item comment_reply" id="comment_item_1387564"><dt class="comment_head" floor="7">Re: <span class="user"><a class="username" href="http://blog.csdn.net/zju3020912063" target="_blank">zju3020912063</a> <span class="ptime">2010-05-20 09:53发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387564" username="zju3020912063"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/zju3020912063" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_zju3020912063.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：如果你用beginInvoke记得不要用全局变量缓存，每次申请一个新缓存，接收完数据，发给UI，然后扔掉。</dd><dl class="comment_item comment_reply" id="comment_item_1387644"><dt class="comment_head" floor="3">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 10:28发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387644" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 zju3020912063：<br>DataReceived的调用速度可能比UI快很多，数据会乱的，可能后发的数据插在先发数据的前面。</dd></dl></dl></dl><dl class="comment_item comment_topic" id="comment_item_1387421"><dt class="comment_head" floor="6">6楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-20 08:29发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387421" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">DataReceived事件处理程序和Close方法内加上lock，估计也可以解决</dd><dl class="comment_item comment_reply" id="comment_item_1387429"><dt class="comment_head" floor="6">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 08:45发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387429" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>Close方法内加Lock没用的。但你关闭串口的操作放在DataReceived中倒是可以，不过你点击界面时候就无法实时的知道是否关闭成功了。因为只设置一个标记，不等待标记的话，什么时候关闭是监听线程说了算。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1387417"><dt class="comment_head" floor="5">5楼 <span class="user"><a class="username" href="http://blog.csdn.net/yutao051" target="_blank">yutao051</a> <span class="ptime">2010-05-20 08:21发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387417" username="yutao051"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/yutao051" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_yutao051.jpg" width="40" height="40"></a></dd><dd class="comment_body">问题是解决了，代码不是很优美，加了2个变量又遍布了几行代码。应该考虑如何复用，否则下次再写串口程序时岂不是又要重写一遍。</dd><dl class="comment_item comment_reply" id="comment_item_1387430"><dt class="comment_head" floor="5">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-20 08:47发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387430" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 yutao051：<br>是的，这是必须的，如果你用api，那就需要自己创建监听线程，监听线程和主线程之间要互斥的访问串口资源。那样更不通用。我这个例子，如果还能优化。顶多去掉closing标记，先注销事件：<br>comm.DataReceived -= comm_DataReceived; <br>然后还是要检测Listening的标记，避免死锁。死锁的原因是并发，解决并发的方法就是等待并执行消息循环。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1386972"><dt class="comment_head" floor="4">4楼 <span class="user"><a class="username" href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank">匿名用户</a> <span class="ptime">2010-05-19 17:21发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1386972" username="匿名用户"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/%E5%8C%BF%E5%90%8D%E7%94%A8%E6%88%B7" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_匿名用户.jpg" width="40" height="40"></a></dd><dd class="comment_body">close之间把删除事件注册就好了<br>comm.DataReceived -= comm_DataReceived;</dd><dl class="comment_item comment_reply" id="comment_item_1387247"><dt class="comment_head" floor="4">Re: <span class="user"><a class="username" href="http://blog.csdn.net/wuyazhe" target="_blank">wuyazhe</a> <span class="ptime">2010-05-19 21:29发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1387247" username="wuyazhe"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wuyazhe" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wuyazhe.jpg" width="40" height="40"></a></dd><dd class="comment_body">回复 匿名用户：<br>不行的，原因上面说过了。关键不是你是否注销了事件，是你关闭的时候，DataReceived没执行完，你关闭串口的时候，会导致2个线程彼此要求对方先释放资源的死锁。</dd></dl></dl><dl class="comment_item comment_topic" id="comment_item_1386726"><dt class="comment_head" floor="3">3楼 <span class="user"><a class="username" href="http://blog.csdn.net/qoushui" target="_blank">qoushui</a> <span class="ptime">2010-05-19 14:56发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1386726" username="qoushui"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/qoushui" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_qoushui.jpg" width="40" height="40"></a></dd><dd class="comment_body">没遇到过。因为我没有在DataReceive中去显示界面。你可以考虑MVC。也可以考虑BACKGROUDWORKER。</dd></dl><dl class="comment_item comment_topic" id="comment_item_1386454"><dt class="comment_head" floor="2">2楼 <span class="user"><a class="username" href="http://blog.csdn.net/wh90317z" target="_blank">wh90317z</a> <span class="ptime">2010-05-19 11:40发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1386454" username="wh90317z"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/wh90317z" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_wh90317z.jpg" width="40" height="40"></a></dd><dd class="comment_body">[e01]你很伟大，我的问题终于解决了</dd></dl><dl class="comment_item comment_topic" id="comment_item_1386328"><dt class="comment_head" floor="1">1楼 <span class="user"><a class="username" href="http://blog.csdn.net/sxiaohui8709253" target="_blank">sxiaohui8709253</a> <span class="ptime">2010-05-19 10:23发表</span>  <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#reply" class="cmt_btn reply" title="回复">[回复]</a> <span class="comment_manage" style="display:none;" commentid="1386328" username="sxiaohui8709253"> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#quote" class="cmt_btn quote" title="引用">[引用]</a> <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#report" class="cmt_btn report" title="举报">[举报]</a></span></span></dt><dd class="comment_userface"><a href="http://blog.csdn.net/sxiaohui8709253" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/3_sxiaohui8709253.jpg" width="40" height="40"></a></dd><dd class="comment_body">感谢楼主分享,解决了我的问题了</dd></dl><div class="clear"></div></div>
<div id="comment_bar" style="display: none; "></div>
<div id="comment_form"><div class="guest_link">您还没有登录,请<a href="http://passport.csdn.net/account/login?from=http%3A%2F%2Fblog.csdn.net%2Fwuyazhe%2Farticle%2Fdetails%2F5606276">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Fwuyazhe%2Farticle%2Fdetails%2F5606276">[注册]</a></div></div>
<div class="announce">* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
<script type="text/javascript">
    var fileName = '5606276';
    var commentscount = 163;
    var islock = false
</script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/comment.js"></script>
<div id="ad_bot"><iframe id="ad_frm_1" frameborder="0" scrolling="no" style="border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; overflow-x: hidden; overflow-y: hidden; width: 732px; height: 0px; " src="about:blank"></iframe></div>
<script type="text/javascript">
    new Ad(5, 'ad_bot');
</script>
<div id="report_dialog"></div>

<div id="d-top">
<a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" onclick="javascript:document.body.scrollTop=0;document.documentElement.scrollTop=0;this.blur();return false;" title="回到顶部">
<img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/top.png" alt="TOP"></a>
</div>



<div class="clear"></div>
</div>
</div>

<div id="side">
<div class="side">
<div id="panel_Profile" class="panel">
    <ul class="panel_head"><span>个人资料</span></ul>
    <ul class="panel_body profile">
        <div id="blog_userface">
            <a href="http://my.csdn.net/wuyazhe" target="_blank">
            <img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/1_wuyazhe.jpg" title="访问我的空间" style="max-width:90%">
            </a>
            <br>
            <span><a href="http://my.csdn.net/wuyazhe" class="user_name" target="_blank">wuyazhe</a></span>
        </div>
<div class="interact">
<!--<a href="#" class="attented" title="已关注"></a>-->
<a href="http://blog.csdn.net/wuyazhe/article/details/5606276#" class="attent" id="span_add_follow" title="[加关注]"></a>
<a href="http://my.csdn.net/my/letter/send/wuyazhe" class="letter" title="[发私信]"></a>
</div>
        <div id="blog_medal">
        <div id="bms_box"></div></div>
        <ul id="blog_rank">
            <li>访问：<span>163624次</span></li>
            <li>积分：<span>1961分</span></li>
            <li>排名：<span>第3540名</span></li>
        </ul>
        <ul id="blog_statistics">
            <li>原创：<span>36篇</span></li>
            <li>转载：<span>3篇</span></li>
            <li>译文：<span>0篇</span></li>
            <li>评论：<span>803条</span></li>
        </ul>
    </ul>
</div>
<script type="text/javascript">
    var _blogger = 'wuyazhe';
</script>
<script type="text/javascript">
$(document).ready(function () {
    var un = getUN().toLowerCase();
    if (un == _blogger.toLowerCase()) {
        $('.interact').hide();
    } else if(un) {
        var url = "http://my.csdn.net/index.php/follow/check_is_followed/" + encodeURIComponent(un) + "/" + encodeURIComponent(_blogger) + "?jsonpcallback=?";
        $.getJSON(url, {}, function (data) {
            if (data.succ == 1 && data.info == 1) {
                $('#span_add_follow').attr('class', 'attented');
            } else {
                $('#span_add_follow').click(guanzhu);
            }
        }, 'json');
    }
});
function guanzhu() {
    var url = "http://my.csdn.net/index.php/follow/do_follow?jsonpcallback=?";
    $.getJSON(url, { "username": _blogger }, function (data) {
        if (data.succ == 1) {
            alert('关注成功！');
            $('#span_add_follow').attr('class', 'attented').click(function () { return false; });
        } else {
            alert(data.msg);
        }
    });
    return false;
}
function getUN() {
    var m = document.cookie.match(new RegExp("(^| )UserName=([^;]*)(;|$)"));
    if (m) return m[2];
    else return '';
}
</script>

<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字"></span>
        <input id="btnSubmit" type="submit" value="搜索" title="search in blog">
        <input type="hidden" name="q" id="inputQ">
        <input type="hidden" name="t" value="blog">
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div><div id="panel_Category" class="panel">
    <ul class="panel_head"><span>文章分类</span></ul>
    <ul class="panel_body">
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/695095">.net 小技巧 - 语法糖</a><span>(10)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/754123">c#开发技巧</a><span>(6)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/695097">通讯类库设计</a><span>(5)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/959879">c#</a><span>(2)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/959880">同步</a><span>(1)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/959881">滚动</a><span>(1)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/959882">Textbox</a><span>(1)</span>
        </li>
        <li>
        <a href="http://blog.csdn.net/wuyazhe/article/category/959883">控件</a><span>(2)</span>
        </li>
    </ul>
</div><div id="panel_Archive" class="panel">
    <ul class="panel_head"><span>文章存档</span></ul>
    <ul class="panel_body">
        <div id="archive_list"><li><a href="http://blog.csdn.net/wuyazhe/article/month/2012/06">2012年06月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2011/12">2011年12月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2011/01">2011年01月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/11">2010年11月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/10">2010年10月</a><span>(3)</span></li><span class="hidelist" style="display:none;"><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/09">2010年09月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/08">2010年08月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/07">2010年07月</a><span>(9)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/06">2010年06月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2010/05">2010年05月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2007/09">2007年09月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2007/01">2007年01月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/wuyazhe/article/month/2006/11">2006年11月</a><span>(1)</span></li></span><div id="archive_list_button" class="list_closed">展开</div></div>
    </ul>
</div>
<div id="hotarticls" class="panel">
    <ul class="panel_head"><span>阅读排行</span></ul>
    <ul class="panel_body itemlist">
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5598945" title="C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a><span>(49785)</span>
        </li>
        <li>
            <a href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET.htm" title="C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？">C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？</a><span>(26328)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5627253" title="C# 串口操作系列(3) -- 协议篇，二进制协议数据解析">C# 串口操作系列(3) -- 协议篇，二进制协议数据解析</a><span>(23111)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5797673" title="C# 串口操作系列(5)--通讯库雏形">C# 串口操作系列(5)--通讯库雏形</a><span>(8752)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5657188" title="C# 串口操作系列(4) -- 协议篇，文本协议数据解析">C# 串口操作系列(4) -- 协议篇，文本协议数据解析</a><span>(7727)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5729338" title="c# 只能输入数字的文本框">c# 只能输入数字的文本框</a><span>(6560)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5728286" title="c# 窗体全屏显示的完整范例">c# 窗体全屏显示的完整范例</a><span>(3260)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5676881" title="List中的值类型无法修改的原因详解">List中的值类型无法修改的原因详解</a><span>(2694)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5642431" title="语法糖(1) -- 打开新窗体，关闭入口窗体的最简化方法">语法糖(1) -- 打开新窗体，关闭入口窗体的最简化方法</a><span>(2506)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5922167" title="全文关键字检索-KMP改进算法">全文关键字检索-KMP改进算法</a><span>(2230)</span>
        </li>
    </ul>
</div>
<div id="hotarticls2" class="panel">
    <ul class="panel_head"><span>评论排行</span></ul>
    <ul class="panel_body itemlist">
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5598945" title="C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a><span>(219)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5627253" title="C# 串口操作系列(3) -- 协议篇，二进制协议数据解析">C# 串口操作系列(3) -- 协议篇，二进制协议数据解析</a><span>(182)</span>
        </li>
        <li>
            <a href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET.htm" title="C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？">C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？</a><span>(163)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5797673" title="C# 串口操作系列(5)--通讯库雏形">C# 串口操作系列(5)--通讯库雏形</a><span>(45)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5657188" title="C# 串口操作系列(4) -- 协议篇，文本协议数据解析">C# 串口操作系列(4) -- 协议篇，文本协议数据解析</a><span>(25)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/6022771" title="c#自杀程序的关键方法">c#自杀程序的关键方法</a><span>(24)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5729338" title="c# 只能输入数字的文本框">c# 只能输入数字的文本框</a><span>(16)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/6011536" title="高效获取网页源码">高效获取网页源码</a><span>(12)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5854512" title="正则表达式之分组捕获、条件表达式、平衡组">正则表达式之分组捕获、条件表达式、平衡组</a><span>(11)</span>
        </li>
        <li>
            <a href="http://blog.csdn.net/wuyazhe/article/details/5676881" title="List中的值类型无法修改的原因详解">List中的值类型无法修改的原因详解</a><span>(9)</span>
        </li>
    </ul>
</div>
<div id="homepageArticles" class="panel">
    <ul class="panel_head"><span>推荐文章</span></ul>
    <ul class="panel_body" id="ad_commend">
    <iframe id="ad_frm_2" frameborder="0" scrolling="no" style="border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; overflow-x: hidden; overflow-y: hidden; width: 182px; height: 0px; " src="about:blank"></iframe></ul>
</div>
<script type="text/javascript">
    new Ad(12, 'ad_commend');
</script><div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5598945#comments">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/china688" class="user_name">china688</a>:
SerialPort 控件的 DataReceived 事件始终无法触发
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5627253#comments">C# 串口操作系列(3) -- 协议篇，二进制协议数据解析</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/wangjian10101" class="user_name">wangjian10101</a>:
咨询楼主一个问题，SerialPort.GetPortNames得不到我PC的串口名称，这个结果是空...
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5676881#comments">List中的值类型无法修改的原因详解</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/cloudfile" class="user_name">cloudfile</a>:
谢谢分享
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5598945#comments">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/chenlaoyang" class="user_name">chenlaoyang</a>:
@yyadbss:这个问题解决了没？我也遇到了
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/7691393#comments">C#无闪烁绘图方法</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/WMMCY" class="user_name">不是为我</a>:
不错，学习了。
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5598945#comments">C# 串口操作系列(1) -- 入门篇，一个标准的，简陋的串口例子。</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/cbwfn" class="user_name">cbwfn</a>:
if(checkSendHex.Checked) {                //我们不管规则...
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5606276#comments">C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/zyin121" class="user_name">zyin121</a>:
看了楼主的文章，获益匪浅啊！一直遇到这个问题，终于知道怎么做了！多谢楼主！
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5729338#comments">c# 只能输入数字的文本框</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/lugon" class="user_name">lugon</a>:
为什么要把数字8单独判断？
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5657188#comments">C# 串口操作系列(4) -- 协议篇，文本协议数据解析</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/lugon" class="user_name">lugon</a>:
谢谢博主，很受益
    </p>
    </li>
    <li>
    <a href="http://blog.csdn.net/wuyazhe/article/details/5797673#comments">C# 串口操作系列(5)--通讯库雏形</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/zhang890724" class="user_name">zhang890724</a>:
厉害
    </p>
    </li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>

<div class="clear"></div>
</div>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/shCore-src.js"></script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ZeroClipboard.js"></script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/article_code.js"></script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/cnick.js"></script>

<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/show.js"></script>
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/showblogmedal.ashx"></script>

<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/publib_footer.js"></script><link rel="stylesheet" type="text/css" href="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/pub_footer_2012.css"><div class="pub_footerall"><dl><dt></dt> <dd><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a></dd><dd>京&nbsp;ICP&nbsp;证&nbsp;070598&nbsp;号</dd><dd>北京创新乐知信息技术有限公司 版权所有</dd><dd>世纪乐知(北京)网络技术有限公司 提供技术支持</dd><dd>江苏乐知网络技术有限公司 提供商务支持</dd><dd><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ico_email.gif" alt="" title=""> 联系邮箱：webmaster(at)csdn.net</dd><dd>Copyright © 1999-2012, CSDN.NET, All Rights Reserved&nbsp;<a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/gongshang_logos.gif" alt="GongshangLogo" title=""></a></dd></dl></div><script type="text/javascript" charset="utf-8" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/tracking.js"></script>

<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script><img src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/pv.aspx" border="0" width="0" height="0">
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/counter.js"></script><script type="text/javascript" charset="UTF-8" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/msg.popup.js"></script>

<!--ad.csdn.net-->
<script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ad-blog.js"></script><script type="text/javascript" src="./C# 串口操作系列(2) -- 入门篇，为什么我的串口程序在关闭串口时候会死锁 ？ - 不要抱怨，要不断的追求，上帝才会给你。 - 博客频道 - CSDN.NET_files/ad-ms460.js"></script>




</div>

</body></html>